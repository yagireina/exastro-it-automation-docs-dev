==========================================
利用手順マニュアル エクスポート/インポート
==========================================

はじめに
========

| 本書は、ITAのエクスポート/インポートの機能および操作方法について説明します。

エクスポート/インポートの概要
=============================

| 本章ではエクスポート/インポートについて説明します。

メニューエクスポート・インポート
--------------------------------

機能について
^^^^^^^^^^^^

| メニューエクスポート・インポートは、移行したいITAのメニューを選択し、メニュー単位でデータを上書きで移行します。

.. figure:: /images/ja/export_import/overview/export_import_simple_diagram.png
  :width: 600px
  :align: center

モードについて
^^^^^^^^^^^^^^

| メニューエクスポート機能には2種類のモードがあります。

1. 環境移行

| 指定メニューのすべてのデータをエクスポートします。インポート先のデータをすべて置き換えます。

.. figure:: /images/ja/export_import/overview/environmental_transition_diagram.png
  :width: 600px
  :align: center

2. 時刻指定

| 指定時刻以降のデータのみエクスポートします。インポート先のデータと一意項目（ID、No等）が重複した場合はエクスポートしたデータが優先してインポートされます。

| 例：2021年1月2日 17:00を指定した場合

.. figure:: /images/ja/export_import/overview/time_designation_transition_diagram.png
  :width: 720px
  :align: center

使用例
^^^^^^

| 本機能ではITAサーバAとITAサーバBの2つの環境を使用して、以下のように機能を利用することを想定しています。

| **パターン①：環境の複製**

| ITAサーバAに登録されているすべてのデータをITAサーバBに複製します。

| [手順]

#. 環境移行モードにてITAサーバAのデータを環境移行モードですべてエクスポートします。
#. 1でエクスポートしたデータをITAサーバBにインポートします。

| ※環境移行後はITAサーバBでデータの登録・更新を行えます。その後、再度ITAサーバAからデータを移行すると不整合が発生する可能性があるため非推奨です。
| ※双方向でのデータの移行は、データの不整合が発生する可能性があるため非推奨です。

.. figure:: /images/ja/export_import/overview/environment_replication.png
  :width: 800px
  :align: center

| **パターン②：データを投入するサーバと作業を実行するサーバを分ける**

| データの投入・テスト用サーバと作業の実行のみを行う用のサーバの2点を用意する場合。

| [手順]

#. 環境移行モードにてITAサーバAのデータをすべてエクスポートします。
#. 1でエクスポートしたファイルをITAサーバBにインポートします。
#. ITAサーバAでデータの更新があるたびにITAサーバBに時刻指定モードで差分データを移行します。

| ※データ移行を複数行う前提の場合、データの登録・更新を行うとデータの不整合が発生する可能性があるため非推奨です。作業の実行のみであれば影響はありません。
| ※サーバBにて作業の実行中にデータを移行する際は、実行中のデータに影響を与えないようにするため、時刻指定モードで差分データのみを移行するようにしてください。
| ※双方向でのデータの移行は、データの不整合が発生する可能性があるため非推奨です。

.. figure:: /images/ja/export_import/overview/separate_servers.png
  :width: 800px
  :align: center

Excel一括エクスポート・インポート
---------------------------------

機能について
^^^^^^^^^^^^

| Execl一括エクスポート・インポートは、各メニューにあるダウンロード可能なファイル（Excel/独自フォーマットのCSV）をzipファイルにまとめて一括でエクスポート・インポートを行うものです。ダウンロード可能なファイルについては『Exastro-ITA_利用手順マニュアル_管理コンソール』を参照してください。
| エクスポート可能なメニューは[ロール・メニュー紐付管理]メニューにて『紐付け』項目が『閲覧のみ』もしくは『メンテナンス可』のデータのみです。
| インポート可能なメニューは[ロール・メニュー紐付管理]メニューにて『紐付け』項目が『メンテナンス可』のデータのみです。

エクスポート/インポートのメニュー、画面構成
===========================================

| 本章では、エクスポート/インポートのメニュー、画面構成について説明します

メニュー 一覧
-------------

| エクスポート/インポートのメニューを以下に示します。

.. table:: 表 2-1 ITAメニュー一覧
   :align: left

   +--------+----------------------+--------------------+------------------+
   | **No** | **メニューグループ** | **メニュー・画面** | **説明**         |
   +========+======================+====================+==================+
   | 1      | エクスポート/インポ\ | メニューエクスポ\  | メニューのデー\  |
   |        | ート                 | ート               | タをエクススポ\  |
   |        |                      |                    | ートします。     |
   +--------+                      +--------------------+------------------+
   | 2      |                      | メニューインポート | メニューの\      |
   |        |                      |                    | データをイ\      |
   |        |                      |                    | ンポートし\      |
   |        |                      |                    | ます。           |
   +--------+                      +--------------------+------------------+
   | 3      |                      | メニューエクスポ\  | [メニューエクス\ |
   |        |                      | ト・インポート管理 | ポート]メニュー\ |
   |        |                      |                    | で実行したエク\  |
   |        |                      |                    | スポートと、[メ\ |
   |        |                      |                    | ニューインポー\  |
   |        |                      |                    | ト]メニューで実\ |
   |        |                      |                    | 行したインポー\  |
   |        |                      |                    | トの状況を管理\  |
   |        |                      |                    | します。         |
   +--------+                      +--------------------+------------------+
   | 4      |                      | Excel一括エクス\   | 各メニューにあ\  |
   |        |                      | ポート             | るダウンロード\  |
   |        |                      |                    | 可能なファイル\  |
   |        |                      |                    | をzipにまとめ、\ |
   |        |                      |                    | エクスポートし\  |
   |        |                      |                    | ます。           |
   +--------+                      +--------------------+------------------+
   | 5      |                      | Excel一括インポ\   | ダウンロード可\  |
   |        |                      | ート               | 能なファイルを\  |
   |        |                      |                    | まとめたzipをイ\ |
   |        |                      |                    | ンポートします。 |
   +--------+                      +--------------------+------------------+
   | 6      |                      | Excel一括エクス\   | [Excel一括エク\  |
   |        |                      | ポート・インポー\  | スポート]メニュ\ |
   |        |                      | ト管理             | ーで実行したエ\  |
   |        |                      |                    | クスポートと、[\ |
   |        |                      |                    | Excel一括インポ\ |
   |        |                      |                    | ート]メニューで\ |
   |        |                      |                    | 実行したインポ\  |
   |        |                      |                    | ートの状況を管\  |
   |        |                      |                    | 理します。       |
   +--------+----------------------+--------------------+------------------+

機能・操作方法説明
==================

メニューエクスポート
--------------------

| ITAシステムに登録されているデータを、メニューごとにエクスポートします。
| データを別のITA環境に移す場合、すべてのメニューを対象に移動しないとデータの整合性が壊れる可能性があります。

| 一部エクスポート対象外のメニューが存在します。対象外のメニューは以下の通りです。

.. table::
   :align: left

   +--------+----------------------+--------------------+----+----------------------+--------------------+
   | **No** | **メニューグループ** | **メニュー・画面** | No | **メニューグループ** | **メニュー・画面** |
   +========+======================+====================+====+======================+====================+
   | 1      | 管理コンソール       | シーケンス管理     | 25 | 比較                 | 比較実行           |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 2      |                      | バージョン情報     | 26 | Ansible-Legacy       | 作業実行           |
   +--------+----------------------+--------------------+----+                      +--------------------+
   | 3      | 基本コンソール       | ER 図表示          | 27 |                      | 作業状態確認       |
   +--------+----------------------+--------------------+----+                      +--------------------+
   | 4      | エクスポート/\       | メニューエクスポ\  | 28 |                      | 作業管理           |
   |        | インポート           | ート               |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 5      |                      | メニューインポート | 29 | Ansible-Pioneer      | 作業実行           |
   +--------+                      +--------------------+----+                      +--------------------+
   | 6      |                      | メニューエクスポ\  | 30 |                      | 作業状態確認       |
   |        |                      | ート・インポート\  |    |                      |                    |
   |        |                      | 管理               |    |                      |                    |
   +--------+                      +--------------------+----+                      +--------------------+
   | 7      |                      | Excel 一括エクス\  | 31 |                      | 作業管理           |
   |        |                      | ポート             |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 8      |                      | Excel 一括インポ\  | 32 | Ansible-LegacyRole   | 作業実行           |
   |        |                      | ート               |    |                      |                    |
   +--------+                      +--------------------+----+                      +--------------------+
   | 9      |                      | Excel 一括エクス\  | 33 |                      | 作業状態確認       |
   |        |                      | ポート・インポー\  |    |                      |                    |
   |        |                      | ト管理             |    |                      |                    |
   +--------+----------------------+--------------------+----+                      +--------------------+
   | 10     | Symphony             | Movement インス\   | 34 |                      | 作業管理           |
   |        |                      | タンス一覧         |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 11     |                      | Symphony           | 35 | Terraform            | 作業実行           |
   |        |                      | クラス編集         |    |                      |                    |
   +--------+                      +--------------------+----+                      +--------------------+
   | 12     |                      | Symphony 作業実行  | 36 |                      | 作業状態確認       |
   +--------+                      +--------------------+----+                      +--------------------+
   | 13     |                      | Symphony 作業確認  | 37 |                      | 作業管理           |
   +--------+                      +--------------------+----+                      +--------------------+
   | 14     |                      | Symphony 作業一覧  | 38 |                      | 連携先 Terraform   |
   |        |                      |                    |    |                      | 管理               |
   +--------+----------------------+--------------------+----+----------------------+--------------------+
   | 15     | Conductor            | Conductor          | 39 | Terraform-CLI        | 作業実行           |
   |        |                      | 作業実行           |    |                      |                    |
   +--------+                      +--------------------+----+                      +--------------------+
   | 16     |                      | Conductor          | 40 |                      | 作業状態確認       |
   |        |                      | 作業確認           |    |                      |                    |
   +--------+                      +--------------------+----+                      +--------------------+
   | 17     |                      | Conductor          | 41 |                      | 作業管理           |
   |        |                      | 作業一覧           |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 18     |                      | Conductor          |    |                      |                    |
   |        |                      | インスタンス一覧   |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 19     |                      | Node               |    |                      |                    |
   |        |                      | インスタンス一覧   |    |                      |                    |
   +--------+----------------------+--------------------+----+----------------------+--------------------+
   | 20     | メニュー作成         | メニュー定義・作成 |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 21     |                      | メニュー作成実行   |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 22     |                      | メニュー作成履歴   |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 23     |                      | 選択1              |    |                      |                    |
   +--------+                      +--------------------+----+----------------------+--------------------+
   | 24     |                      | 選択2              |    |                      |                    |
   +--------+----------------------+--------------------+----+----------------------+--------------------+

| (1) エクスポートするモードと廃止情報を選択します。
| モード一覧と廃止情報一覧を以下に示します。

.. table:: 表 3‑1 モード一覧
   :align: left

   +----------+----------------------------------------------------------+
   | **名称** | **説明**                                                 |
   +==========+==========================================================+
   | 環境移行 | インポ\                                                  |
   |          | ート時、既存データをすべて削除してデータを上書きします。 |
   +----------+----------------------------------------------------------+
   | 時刻指定 | インポート時、指定した時刻以降に入力されたデータを各\    |
   |          | メニューの一意項目（ID、No等）を基に挿入・上書きします。 |
   +----------+----------------------------------------------------------+

.. table:: 表 3‑2 廃止情報一覧
   :align: left

   +------------+------------------------------------------------------------+
   | **名称**   | **説明**                                                   |
   +============+============================================================+
   | 廃止を含む | 廃止状態のデータを含むすべてのデータをエクスポートします。 |
   +------------+------------------------------------------------------------+
   | 廃止を除く | 廃止状態のデータを除いたデータをエクスポートします。       |
   +------------+------------------------------------------------------------+

| (2) エクスポートするメニューを選択します。

|image4|
|image5|
|image6|

**図 3‑1 メニューエクスポート画面(1)**

| (3) メニューを選択後、《エクスポート》ボタンを押下します。
| エクスポート処理の実行№が表示されるので、メニューエクスポート・インポート管理画面で処理のステータスを確認してください。

|image7|

**図 3‑2 メニューエクスポート画面(2)**

メニューインポート
------------------

| [メニューエクスポート]メニューでエクスポートしたデータをインポートします。

| (1) インポートするファイルを選択して《アップロード》ボタンを押下します。

|image8|

**図 3‑3 メニューインポート画面(1)**

| (2) インポートしたファイル内のメニューの一覧が表示されます。インポートするメニューを選択して《インポート》ボタンを押下します。
| チェックボックスがチェックされているメニューがインポートされます。
| インポートする必要がないメニューは、チェックは外してください。

|image9|
|image10|
|image11|

**図 3‑4メニューインポート画面(2)**

| (3) 受付画面に遷移します。《エクスポート・インポート管理》ボタンを押下すると、[メニューエクスポート・インポート管理]メニューに遷移してインポートの状況確認が行えます。

|image12|

**図 3‑5 メニューインポート画面(3)**

メニューエクスポート・インポート管理
------------------------------------

| [メニューエクスポート]メニューで実行したエクスポートと、[メニューインポート]メニューで実行したインポートの状況を管理します。ログインユーザが実行したデータのみ表示されます。

|image13|

**図 3‑6 メニューエクスポート・インポート管理画面**

.. table:: 表 3‑3 一覧画面項目一覧（メニューエクスポート・インポート管理）
   :align: left

   +------------+--------------------------------------------------------------------------------------------------------------+
   | **項目**   | **説明**                                                                                                     |
   +============+==============================================================================================================+
   | 実行No.    | 一意のIDが自動採番されます                                                                                   |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | ステータス | | 〔未実行〕、〔実行中〕、〔完了〕の順に遷移します。                                                         |
   |            |                                                                                                              |
   |            | | エラーが発生した場合は、〔完了(異常)〕になります。                                                         |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 処理種別   | | エクスポート・・・メニューエクスポート                                                                     |
   |            | | インポート・・・メニューインポート                                                                         |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | モード     | 〔環境移行〕または〔時刻指定〕が表示されます。                                                               |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 廃止情報   | 〔廃止を含む〕または〔廃止を除く〕が表示されます。                                                           |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 指定時刻   | モードが〔時刻指定〕の場合にのみ表示されます。                                                               |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | ファイル名 | | エクスポートの場合、〔完了〕になるとエクスポートデータが表示されるので、ダウンロードして使用してください。 |
   |            |                                                                                                              |
   |            | | インポートの場合、インポートしたデータが表示されます。                                                     |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 実行ユーザ | | エクスポート処理またはインポート処理を実行したユーザが表示されます。                                       |
   |            |                                                                                                              |
   |            | | 1.7.2以前から1.8.0以降にバージョンアップした場合は『実行ユーザ』項目が追加されます。                       |
   |            |                                                                                                              |
   |            | | 『実行ユーザ』項目が空またはログインユーザと一致している場合データが表示されます。                         |
   +------------+--------------------------------------------------------------------------------------------------------------+

Excel一括エクスポート
---------------------

| 各メニューにあるダウンロード可能なファイルをzipにまとめ、エクスポートします。

| (1) エクスポートする廃止情報を選択します。
| 廃止情報一覧を以下に示します。

.. table:: 表 3‑4 廃止情報一覧
   :align: left

   +------------+------------------------------------------------------+
   | **名称**   | **説明**                                             |
   +============+======================================================+
   | 全レコード | すべてのデータをエクスポートします。                 |
   +------------+------------------------------------------------------+
   | 廃止を除く | 廃止状態のデータを除いたデータをエクスポートします。 |
   +------------+------------------------------------------------------+
   | 廃止のみ   | 廃止状態のデータのみエクスポートします。             |
   +------------+------------------------------------------------------+

| (2) エクスポートするメニューを選択します。
| 表示されるメニューは[ロール・メニュー紐付管理]メニューの『紐付』項目が『メンテナンス可』もしくは『閲覧のみ』となっているデータのみです。

|image14|
|image15|
|image16|

**図 3‑7 Excel一括エクスポート画面(1)**

| (3) メニューを選択後、《エクスポート》ボタンを押下します。
| エクスポート処理の実行№が表示されるので、[Excel一括エクスポート・インポート管理]メニューで処理のステータスを確認してください。

|image17|

**図 3‑8 Excel一括エクスポート画面(2)**

| (4) エクスポートしたファイルの中身は以下の通りです。

.. code-block::
   :name: ファイル構成

   ITA_FILES_YYYYMMDDhhmmss.zip …①                                     
   ├─ MENU_LIST.txt …②
   ├─ 2100000002_管理コンソール …③
   │　 ├─ ユーザ管理_20210708235958.xlsx …④
   │   └─ メニュー管理_20210708235959.xlsx …④
   ├─ 2100000003_基本コンソール
   │   ├─ 機器一覧_20210708235858.scsv …④
   │   └─ 機器一覧_20210708235859.xlsx …⑤
   └─ editBaker …⑥

.. table:: 
   :align: left

   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | **No** | **名称**             | **拡張子** | **説明**                                                                                                                                                                                              |
   +========+======================+============+=======================================================================================================================================================================================================+
   | 1.     | ファイル名           | ファイル   | ファイル名は\                                                                                                                                                                                         |
   |        |                      |            | 『ITA_FILES_YYYYMM                                                                                                                                                                                    |
   |        |                      |            | DDhhmmss.zip』です。                                                                                                                                                                                  |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | 2.     | MENU_LIST.txt        | txt        | エ\                                                                                                                                                                                                   |
   |        |                      |            | クスポートしたメニュ                                                                                                                                                                                  |
   |        |                      |            | ーＩＤとファイル名の                                                                                                                                                                                  |
   |        |                      |            | 一覧が出力されます。                                                                                                                                                                                  |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | 3.     | メニ\                | フォルダ   | | メニューグループごとに生成されます。                                                                                                                                                                |
   |        | ューグループフォルダ |            |                                                                                                                                                                                                       |
   |        |                      |            | | フォルダ名は『メニューグループID_メニューグループ名』です。                                                                                                                                         |
   |        |                      |            |                                                                                                                                                                                                       |
   |        |                      |            | | フォルダ名が200文字を超える場合は前方から200文字のみ出力されます。                                                                                                                                  |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | 4.     | ダウンロードファイル | xlsx/scsv  | | Ｅｘｃｅｌまたは独自フォーマットのＣＳＶとして出力されます。（『各メニュー項目一覧』が[メニュー管理]メニューの『Excel出力最大行数』を超えている場合、独自フォーマットのＣＳＶとして出力されます。） |
   |        |                      |            |                                                                                                                                                                                                       |
   |        |                      |            | | 所属するメニューグループフォルダの下に配置されます。                                                                                                                                                |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | 5.     | 独自フォーマット編\  | xlsx       | | 独自フォーマットのＣＳＶを編集する際に使用する素材です。                                                                                                                                            |
   |        | 集Ｅｘｃｅｌ作成素材 |            |                                                                                                                                                                                                       |
   |        |                      |            | | 出力ファイルに独自フォーマットのＣＳＶが含まれる場合のみ出力されます。                                                                                                                              |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | 6.     | editBaker            | フォルダ   | | 独自フォーマット編集Ｅｘｃｅｌ作成ツールです。                                                                                                                                                      |
   |        |                      |            |                                                                                                                                                                                                       |
   |        |                      |            | | 出力ファイルに独自フォーマットのＣＳＶが含まれる場合のみ出力されます。                                                                                                                              |
   +--------+----------------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Excel一括インポート
-------------------

| [Excel一括エクスポート]メニューでエクスポートしたデータを編集し、インポートします。

1. Zipファイルの編集

| (1) インポートするファイルリストを作成します。
| [Excel一括エクスポート]メニューでエクスポートしたzip内にあるMENU_LIST.txtを編集することによってインポートするファイルリストを編集することができます。
| MENU_LIST.txtはエクスポートした時点のメニューIDとファイル名が記載されています。

| 『#』から始まる行はコメントとして入力することができます。
| フォーマットは以下の通りです。

| メニューID:ファイル名

|image18|

**図 3‑9 MENU_LIST.txt**

| ※インポートするメニューは[Excel一括インポート]メニューでも選択可能です。

| (2) インポートするファイル（Excelまたは独自フォーマットのCSV）を編集します。

| (3) 編集したファイルをzipにまとめます。
| インポートに必要なファイルは以下の通りです。
| ・MENU_LIST.txt
| ・インポートするファイル（Excelまたは独自フォーマットのCSV）

2. インポート処理

| (1) 《ファイル選択》ボタンを押下し、インポートするzipをアップロードします。

|image19|

**図 3‑10 Excel一括インポート画面(1)**

| (2) インポートしたファイル内のメニューの一覧が表示されます。インポートするメニューを選択して《インポート》ボタンを押下します。
| チェックボックスがチェックされているメニューがインポートされます。
| MENU_LIST.txtに記載されてあるファイルが上から順にインポートされます。
| インポートする必要がないメニューは、チェックは外してください。

|image20|

**図 3‑11 Excel一括インポート画面(2)**

| 以下の条件に当てはまる場合、エラーとなりチェックボックスが非活性化されます。
| １．MENU_LIST.txtに２つ以上同じＩＤを指定する
| ２．MENU_LIST.txtに２つ以上の別メニューＩＤに同じファイル名を指定する
| ３．MENU_LIST.txtのフォーマットに沿ってない記述がある
| ４．MENU_LIST.txtで存在しないメニューＩＤを記載する
| ５．MENU_LIST.txtでインポートしたzip内に存在しないファイルを指定する
| ６．別のフォルダに同名のファイルが２つ以上ある
| ７．対象メニューに対しログインユーザが『メンテナンス可』の権限を有していない

3. 受付画面に遷移します。《Excel一括エクスポート・インポート管理》ボタンを押下すると、[Excel一括エクスポート・インポート管理]メニューに遷移してインポートの状況確認が行えます。

|image21|

**図 3‑12 Excel一括インポート画面(3)**

Excel一括エクスポート・インポート管理
-------------------------------------

| [Excel一括エクスポート]メニューで実行したエクスポートと、[Excel一括インポート]メニューで実行したインポートの状況を管理します。ログインユーザが実行したデータのみ表示されます。

|image22|

**図 3‑13 Excel一括エクスポート・インポート管理画面**

.. table:: 表 3‑5 一覧画面項目一覧（メニューエクスポート・インポート管理）
   :align: left

   +------------+--------------------------------------------------------------------------------------------------------------+
   | **項目**   | **説明**                                                                                                     |
   +============+==============================================================================================================+
   | 実行No.    | 一意のIDが自動採番されます                                                                                   |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | ステータス | | 〔未実行〕、〔実行中〕、〔完了〕の順に遷移します。                                                         |
   |            |                                                                                                              |
   |            | | エラーが発生した場合は、〔完了(異常)〕になります。                                                         |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 処理種別   | | エクスポート・・・Excel一括エクスポート                                                                    |
   |            |                                                                                                              |
   |            | | インポート・・・Excel一括インポート                                                                        |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 廃止情報   | 〔全レコー\                                                                                                  |
   |            | ド〕、〔廃止を除く〕または〔廃止のみ〕が表示されます。                                                       |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 実行ユーザ | エクスポート処\                                                                                              |
   |            | 理またはインポート処理を実行したユーザが表示されます。                                                       |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | ファイル名 | | エクスポートの場合、〔完了〕になるとエクスポートデータが表示されるので、ダウンロードして使用してください。 |
   |            |                                                                                                              |
   |            | | インポートの場合、インポートしたデータが表示されます。                                                     |
   +------------+--------------------------------------------------------------------------------------------------------------+
   | 結果       | | インポートした結果を記載したテキストファイルが表示されます。                                               |
   |            |                                                                                                              |
   |            | | ダウンロードして使用してください。                                                                         |
   +------------+--------------------------------------------------------------------------------------------------------------+

| 結果ファイルのサンプルを以下に示します。
| インポートしたファイル単位で結果が出力されます。

.. code-block::

   2100000003_基本コンソール:2100000501_紐付対象メニュー
   入力ファイル:Ansible紐付対象メニュー_20210708023537.xlsx

   登録: 0件
   更新: 2件
   廃止: 1件
   復活: 1件
   エラー: 0件

   2100000002_管理コンソール:2100000208_ユーザ管理
   入力ファイル:ユーザ_20210624111008.xlsx

   登録: 0件
   更新: 0件
   廃止: 0件
   復活: 0件
   エラー: 1件

   line: 11　ユーザ名:次の条件を満たす必要があります。(条件:タブと改行以外の文字(最小値:1バイト,最大値:270バイト))
   必須項目です。(項目:ユーザ名)

   2100000003_基本コンソール:2100000327_ER図メニュー管理
   入力ファイル:ER図メニュー管理_20210708023538.xlsx
   このメニューの編集用Excelファイルではありません。

.. |image1| image:: export_Import/image1.png
   :width: 8.24645in
   :height: 11.7091in
.. |image2| image:: export_Import/image3.emf
   :width: 1.53125in
   :height: 0.34375in
.. |image3| image:: export_Import/image30.emf
   :width: 1.53125in
   :height: 0.34375in
.. |image4| image:: export_Import/image4.png
   :width: 6.09386in
   :height: 2.2602in
.. |image5| image:: export_Import/image5.png
   :width: 6.83194in
   :height: 0.1625in
.. |image6| image:: export_Import/image6.png
   :width: 6.07463in
   :height: 2.9954in
.. |image7| image:: export_Import/image7.png
   :width: 6.37389in
   :height: 1.26011in
.. |image8| image:: export_Import/image8.png
   :width: 5.97385in
   :height: 1.47346in
.. |image9| image:: export_Import/image5.png
   :width: 6.35821in
   :height: 0.15144in
.. |image10| image:: export_Import/image9.png
   :width: 5.48047in
   :height: 2.56689in
.. |image11| image:: export_Import/image10.png
   :width: 5.38958in
   :height: 1.32545in
.. |image12| image:: export_Import/image11.png
   :width: 5.78717in
   :height: 1.43346in
.. |image13| image:: export_Import/image12.png
   :width: 6.36522in
   :height: 2.68402in
.. |image14| image:: export_Import/image13.png
   :width: 6.04052in
   :height: 2.44688in
.. |image15| image:: export_Import/image5.png
   :width: 6.83194in
   :height: 0.1625in
.. |image16| image:: export_Import/image14.png
   :width: 6.0625in
   :height: 2.58604in
.. |image17| image:: export_Import/image15.png
   :width: 6.69236in
   :height: 1.47292in
.. |image18| image:: export_Import/image16.png
   :width: 4.26087in
   :height: 0.87791in
.. |image19| image:: export_Import/image17.png
   :width: 6.06719in
   :height: 1.58014in
.. |image20| image:: export_Import/image18.png
   :width: 6.5339in
   :height: 2.88692in
.. |image21| image:: export_Import/image19.png
   :width: 5.94718in
   :height: 1.51346in
.. |image22| image:: export_Import/image20.png
   :width: 6.26721in
   :height: 2.62023in
