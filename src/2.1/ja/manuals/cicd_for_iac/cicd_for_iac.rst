
=================
CI/CD For IaC機能
=================


用語の定義
**********

| 本書では以下として記載します。

.. table:: 用語説明
   
   +------------+--------------------------------------------------------+
   | 用語名     | 内容                                                   |
   +============+========================================================+
   | ITA        | 「Exastro IT Automation」の略語です。                  |
   +------------+--------------------------------------------------------+
   | 紐付元資材 | CI/CD For\                                             |
   |            | IaC機能で連携するGitリポジトリ内の資材を表します。     |
   +------------+--------------------------------------------------------+
   | 紐付先資材 | ITAの連携ドライバ「Ansibl\                             |
   |            | e-Driver」と「Terraform-Driver」と「Terraform-CLI-Driv\|
   |            | er」の下記メニューからアップロードする資材を表します。 |
   |            |                                                        |
   |            | - Ansible-Legacy/Playbook素材集                        |
   |            |                                                        |
   |            | - Ansible-Pioneer/対話ファイル素材集                   |
   |            |                                                        |
   |            | - Ansible-LegacyRole/ロールパッケージ管理              |
   |            |                                                        |
   |            | - Ansible共通/ファイル管理                             |
   |            |                                                        |
   |            | - Ansible共通/テンプレート管理                         |
   |            |                                                        |
   |            | - Terraform/Module素材集                               |
   |            |                                                        |
   |            | - Terraform/Policy管理                                 |
   |            |                                                        |
   |            | - Terraform-CLI/Module素材集                           |
   +------------+--------------------------------------------------------+


はじめに
========

| 本書では、CI/CD For IaC機能の機能および操作方法について説明します。

CI/CD For IaC機能の概要
=======================


機能概要
--------

| CI/CD For IaC機能は、大きく分けて2つの機能があります。

#. | Git連携機能

   | ITA内にGitリポジトリのクローンを作成します。
   | クローンを介して定期的に紐付元資材の更新を検知しITAの「リモートリポジトリ資材」メニューに一覧を作成します。

#. | 資材紐付機能

   | 紐付元資材と紐付先資材の紐付を登録し、紐付先資材の動作検証を行う為のオペレーションとMovementを登録します。
   | 紐付元資材が更新されると、紐付先資材が自動更新され、動作検証を行う為のオペレーションとMovementで作業実行を行います。


機能概要図
----------

| CI/CD For IaC機能の概要図を以下に示します。


.. image:: /images/ja/cicd_for_iac/CICD_overviews.png
   :width: 5.68819in
   :height: 3.35972in

CI/CD For IaC機能 メニュー構成
==============================

| 本章では、CI/CD For IaC機能のメニュー構成について説明します。
| なお、Webへのログイン方法、およびメニュー画面の構成要素/基本的な操作については、
| 「利用手順マニュアル_管理コンソール」を参照してください。 

メニュー/画面一覧
-----------------

| CI/CD For IaC機能のメニュー一覧を以下に記述します。

.. table:: 表 2.1-1 CI/CD For IaC機能 メニュー一覧
   
   +--------+---------------+---------------+----------+---------------+
   | **No** | **メニュ\     | **メニ\       | **段落** | **概要**      |
   |        | ーグループ**  | ュー・画面**  |          |               |
   +========+===============+===============+==========+===============+
   | 1      | CI/CD For IaC | インター\     | 4.2.1    | ITAの\        |
   |        |               | フェース情報  |          | RestAPIで紐付\|
   |        |               |               |          | 先資材にアク\ |
   |        |               |               |          | セスする為の\ |
   |        |               |               |          | インタフェー\ |
   |        |               |               |          | ス情報を管理  |
   +--------+               +---------------+----------+---------------+
   | 2      |               | リモー\       | 4.1.1    | Gitリポジトリ\|
   |        |               | トリポジトリ  |          | の情報を管理  |
   +--------+               +---------------+----------+---------------+
   | 3      |               | 登\           | 4.1.2    | I\            |
   |        |               | 録アカウント  |          | TAのRestAPIで\|
   |        |               |               |          | 紐付先資材に\ |
   |        |               |               |          | アクセスする\ |
   |        |               |               |          | 為のアカウン\ |
   |        |               |               |          | ト情報を管理\ |
   +--------+               +---------------+----------+---------------+
   | 4      |               | リモートリ\   | 4.2.2    | Gitリ\        |
   |        |               | ポジトリ資材  |          | ポジトリの資\ |
   |        |               |               |          | 材情報を管理  |
   +--------+               +---------------+----------+---------------+
   | 5      |               | 資材紐付      | 4.1.3    | 紐付\         |
   |        |               |               |          | 元資材と紐付\ |
   |        |               |               |          | 先資材との紐\ |
   |        |               |               |          | 付情報を管理\ |
   +--------+---------------+---------------+----------+---------------+

  

CI/CD For IaC機能 利用手順
===========================

| CI/CD For IaC機能の利用手順について説明します。

作業フロー
----------

| CI/CD For IaC機能の標準的な作業フローは以下のとおりです。
| 各作業の詳細は次項に記載しています。

.. image:: /images/ja/cicd_for_iac/CICD_flow.png
   :width: 5.68819in
   :height: 3.35972in


**作業フロー詳細と参照先**

#. | インターフェース情報の登録
   | ITAのRestAPIから紐付先資材にアクセスする為のインターフェース情報を登録します。
   | デフォルトは、インストール先のITAにアクセスする為のインターフェース情報が登録されています。
   | 紐付先資材をインストール先のITA以外にしたい場合に、インターフェース情報を変更して下さい。
   | 詳細は「4.2.1 インタフェース情報」メニューを参照してください。

#. | リモートリポジトリの登録
   | 連携するGitリポジトリの情報を登録します。
   | 詳細は「4.1.1 リモートリポジトリの登録」メニューを参照してください。

#. | 登録アカウントの登録
   | ITAのRestAPIから紐付先資材にアクセスする為のアカウント情報を登録します。
   | 詳細は「34.1.2 登録アカウント」メニューを参照してください。

#. | 資材紐付の登録
   | 紐付元資材と紐付先資材の紐付を登録します。
   | 詳細は「34.1.3 資材紐付」メニューを参照してください。

#. | 資材紐付にオペレーション+Movementの情報を登録
   | 更新された紐付先資材の動作検証を行う場合に、オペレーションとMovementを登録します。
   | 詳細は「34.1.3 資材紐付」メニューを参照してください。

#. | 自動での資材更新と動作検証の確認
   | 紐付元資材が更新される度に、紐付先資材が自動更新されることを確認します。
   | また、オペレーションとMovementを登録している場合に、作業実行が自動で行われることを確認します。
   | 詳細は「34.1.3 資材紐付」メニューを参照してください。


CI/CD For IaC機能メニュー操作説明
=================================

| 本章では、CI/CD For IaC機能のメニュー操作について説明します。


 
CI/CD For IaC 標準メニュー
--------------------------

| 本節では、CI/CD For IaC機能をインストールした状態で表示されるメニューの操作について記載します。

**4.1.1. リモートリポジトリ**


1. | 「リモートリポジトリ」メニューでは、連携するGItリポジトリの情報を登録します。

   .. {{2系のリモートリポジトリ画面を差し込む}}

**図** **4.1‑1メニュー画面（リモートリポジトリ）**

2. | リモートリポジトリ画面の入力項目は以下の通りです。

   .. table:: 表 4.1-1 リモートリポジトリ画面 入力項目一覧（リモートリポジトリ）
      
      +---------------+----------------------------------+----------+---------------+-----------------+
      | **項目**      | **説明**                         | **入力\  | **入\         | **制\           |          
      |               |                                  | 必須**   | 力形式**      | 約事項**        |          
      +===============+==================================+==========+===============+=================+
      | リモート\     | CI/CD For IaC 機能の各メニューで\| 〇       | 手動入力      | 最大長256バイト |
      | リポジトリ名  | リモートリポジトリを示す名称を\  |          |               |                 |
      |               | 示す名称を入力してください。     |          |               |                 |       
      +---------------+----------------------------------+----------+---------------+-----------------+
      | リモート\     | git clone コマンドに指定する Git\| 〇       | 手動入力      | 最大長256バイト |
      | リポジトリ    | リポジトリの URL を入力してくだ\ |          |               |                 |
      | (URL)         | さい。                           |          |               |                 |
      +---------------+----------------------------------+----------+---------------+-----------------+
      | ブランチ      | git cloneコマンドに指定する Git\ | ー       | 手動入力      | 最大長256バイト |            
      |               | リポジトリのブランチ名を入力して\|          |               |                 | 
      |               | 下さい。                         |          |               |                 |
      |               |                                  |          |               |                 |  
      |               | 未入力時は default ブランチが\   |          |               |                 |    
      |               | 指定されます。                   |          |               |                 |   
      +---------------+----------------------------------+----------+---------------+-----------------+
      | プロトコル    | Gitリポジトリと接続するプロトコ\ | 〇       | リスト選択    |                 |
      |               | ルを選択して下さい。             |          |               |                 |
      |               |                                  |          |               |                 |      
      |               | ● https                          |          |               |                 |
      |               |                                  |          |               |                 | 
      |               | リモートのGitリポジトリとhttpsで\|          |               |                 |
      |               | 接続する場合に選択してください。 |          |               |                 | 
      |               |                                  |          |               |                 |     
      |               | ● sshパスワード認証              |          |               |                 |
      |               |                                  |          |               |                 |
      |               | リモートのGitリポジトリとsshの\  |          |               |                 |
      |               | パスワード認証で接続する場合に\  |          |               |                 |
      |               | 選択して下さい。                 |          |               |                 |
      |               |                                  |          |               |                 | 
      |               | ● ssh鍵認証(パスフレーズなし)    |          |               |                 | 
      |               |                                  |          |               |                 | 
      |               | リモートのGitリポジトリとsshの鍵\|          |               |                 |
      |               | 認証で接続する場合に選択して\    |          |               |                 |    
      |               | 下さい。                         |          |               |                 |
      |               |                                  |          |               |                 |
      |               | ● ssh鍵認証(パスフレーズあり)    |          |               |                 |
      |               |                                  |          |               |                 | 
      |               | リモートのGitリポジトリとsshの\  |          |               |                 |       
      |               | パスフレーズ付鍵認証で接続する\  |          |               |                 |
      |               | 場合に選択して下さい。           |          |               |                 |
      |               |                                  |          |               |                 |    
      |               | ● Local                          |          |               |                 |
      |               |                                  |          |               |                 |       
      |               | ローカルの Git の場合に選択して\ |          |               |                 |
      |               | 下さい。                         |          |               |                 |
      +---------------+----------------------------------+----------+---------------+-----------------+ 
      | Visibility\   | GitリポジトリのVisibilityタイプ\ | ー       | リスト選択    |                 |                                    
      | タイプ        | (Public/Private)を選択して\      |          |               |                 |
      |               | 下さい。                         |          |               |                 |    
      |               | プロトコルでhttpsを選択した場合、|          |               |                 |      
      |               | Visibilityタイプの選択は必須\    |          |               |                 |
      |               | 入力です。                       |          |               |                 |    
      +------+--------+----------------------------------+----------+---------------+-----------------+
      | Git\ | ユーザ | Git cloneコマンド実行時に求め\   | ー       | 手動入力      | 最大長128バイト |                           
      | アカ\|        | られるユーザを入力して下さい。   |          |               |                 |
      | ウン\|        | VisibilityタイプでPrivateを選択\ |          |               |                 | 
      | ト   |        | した場合、ユーザの入力は必須で\  |          |               |                 |
      |      |        | す。                             |          |               |                 |
      |      +--------+----------------------------------+----------+---------------+-----------------+
      |      | パス\  | Gitのcloneコマンドを実行した際に\| ー       | 手動入力      | 最大長128バイト | 
      |      | ワード | 求められるパスワードを入力して\  |          |               |                 |  
      |      |        | ください。                       |          |               |                 |
      |      |        |                                  |          |               |                 |    
      |      |        | Visibility タイプでPrivateを選択\|          |               |                 |
      |      |        | した場合、パスワードの入力は必須\|          |               |                 |
      |      |        | です。                           |          |               |                 | 
      |      |        |                                  |          |               |                 |            
      |      |        | 尚、GitHubでは2021年8月13 日で\  |          |               |                 |          
      |      |        | パスワード認証が廃止されます。   |          |               |                 |   
      |      |        |                                  |          |               |                 |
      |      |        | `参考URL <https://github.blog/202|          |               |                 | 
      |      |        | 0-12-15-token-authentication-requ|          |               |                 |  
      |      |        | irements-for-git-operations/>`__ |          |               |                 |   
      |      |        |                                  |          |               |                 | 
      |      |        | パスワード認証が廃止され\        |          |               |                 |
      |      |        | ている GitHub を利用している場\  |          |               |                 |
      |      |        | 合、Git アカウント情報のパスワー\|          |               |                 |
      |      |        | ドには、自身で個人アクセストーク\|          |               |                 |
      |      |        | ンを作成し入力して下さい。       |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | `個人アクセストークン作成法 <http|          |               |                 |    
      |      |        | s://docs.github.com/ja/authentica|          |               |                 |
      |      |        | tion/keeping-your-account-and-dat|          |               |                 |
      |      |        | a-secure/creating-a-personal-acce|          |               |                 |
      |      |        | ss-token>`__                     |          |               |                 |
      +------+--------+----------------------------------+----------+---------------+-----------------+
      | ssh\ | パス\  | Git cloneコマンド実行時に求めら\ | ー       | 手動入力      | 最大長128バイト |
      | 接続\| ワード | れる Linux ユーザのパスワードを\ |          |               |                 |
      | 情報 |        | 入力して下さい。                 |          |               |                 | 
      |      |        |                                  |          |               |                 | 
      |      |        | プロトコルでsshパスワード認証を\ |          |               |                 |
      |      |        | 選択した場合、パスワードの入力\  |          |               |                 |
      |      |        | は必須です。                     |          |               |                 |
      |      +--------+----------------------------------+----------+---------------+-----------------+
      |      | パス\  | Git cloneコマンド実行時に求めら\ | ー       | 手動入力      | 最大長128バイト |
      |      | フレー\| れる鍵ファイルに設定されている\  |          |               |                 |
      |      | ズ     | パスフレーズを入力して下さい。   |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | プロトコルでssh鍵認証を選択した\ |          |               |                 |
      |      |        | 場合、パスフレーズの入力は必須\  |          |               |                 |
      |      |        | です。                           |          |               |                 |    
      |      +--------+----------------------------------+----------+---------------+-----------------+
      |      | 接続\  | Gitのcloneコマンドを実行時に\    | ー       | 手動入力      | 最大長512バイト |
      |      | パラ\  | 環境変数「GIT_SSH_COMMANDに設定\ |          |               |                 |
      |      | メータ | するパラメータを入力します。     |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | GIT＿SSH＿COMMANDは、Git2.3以降\ |          |               |                 |
      |      |        | のバージョンで設定できる環境変数\|          |               |                 |
      |      |        | です。                           |          |               |                 |    
      |      |        | ITAサーバにインストールされてい\ |          |               |                 |
      |      |        | ているGitバージョンがGit2.3より\ |          |               |                 |
      |      |        | 古い場合は、設定されたパラメータ\|          |               |                 |
      |      |        | は無効になります。               |          |               |                 |
      |      |        |                                  |          |               |                 |  
      |      |        | 環境変数「GIT_SSH_COMMAND」は\   |          |               |                 |
      |      |        | デフォルトで下記のパラメータを設\|          |               |                 |
      |      |        | 定しています。                   |          |               |                 |
      |      |        | 設定されたパラメータはこの後ろに\|          |               |                 |
      |      |        | 追加されます。                   |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | UserKnownHostsFile=/dev/null -o \|          |               |                 |
      |      |        | StrictHostKeyChecking=no         |          |               |                 |
      |      |        |                                  |          |               |                 |       
      |      |        | また、git config-globalにcore.ss\|          |               |                 |
      |      |        | hCommandの設定が無い場合、下記の\|          |               |                 |
      |      |        | パラメータを設定します。         |          |               |                 |
      |      |        |                                  |          |               |                 |    
      |      |        | ssh –o UserKnownHostsFile=/dev/n\|          |               |                 |
      |      |        | ull -o StrictHostKeyChecking=no\ |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | git config –globalにcore.sshCom\ |          |               |                 | 
      |      |        | mand を設定している場合、下記の\ |          |               |                 |
      |      |        | パラメータを含めて下さい。       |          |               |                 |  
      |      |        |                                  |          |               |                 |
      |      |        | -o UserKnownHostsFile=/dev/null\ |          |               |                 |
      |      |        | -o StrictHostKeyChecking=no      |          |               |                 |
      +------+--------+----------------------------------+----------+---------------+-----------------+                   
      | Proxy| Address| プロキシサーバのアドレスを入力\  | ー       | 手動入力      | 最大長128バイト |
      |      |        | します。                         |          |               |                 |
      |      |        |                                  |          |               |                 |  
      |      |        | ITA がプロキシ環境下にある場合、\|          |               |                 |
      |      |        | Gitサーバまでの疎通のために設定\ |          |               |                 |  
      |      |        | が必要な場合があります。         |          |               |                 |    
      |      |        |                                  |          |               |                 | 
      |      |        | プロキシサーバの URL がhttp://pro|          |               |                 |   
      |      |        | cy.gate.co.jp:8080 の場合        |          |               |                 |
      |      |        |                                  |          |               |                 |
      |      |        | Address には http://procy.gate.c\|          |               |                 |  
      |      |        | o.jp を入力します。              |          |               |                 |
      |      |        |                                  |          |               |                 |  
      |      |        | Port には 8080 を入力します。    |          |               |                 |     
      |      +--------+----------------------------------+----------+---------------+-----------------+
      |      | port   | プロキシサーバのポートを入力し\  | ー       | 手動入力      |                 |
      |      |        | ます。                           |          |               |                 |
      |      |        |                                  |          |               |                 |    
      |      |        | ITAがプロキシ環境下にある場合、  |          |               |                 |
      |      |        | Git サーバまでの疎通のために設定\|          |               |                 |
      |      |        | が必要な場合があります。         |          |               |                 |
      +------+--------+----------------------------------+----------+---------------+-----------------+
      | リ\  | 自動\  | Gitリポジトリとの同期を自動で\   | 〇       | リスト選択    | 初期値：有効    |
      | モ\  | 同期   | 行うかを選択して下さい。         |          |               |                 |
      | ー\  |        |                                  |          |               |                 |
      | ト\  |        | 有効：入力された周期で Gitリポジ\|          |               |                 |
      | 同\  |        | トリとの同期を行います。         |          |               |                 |
      | 期\  |        |                                  |          |               |                 |
      | 情\  |        | 無効:Gitリポジトリとの同期は自動\|          |               |                 |
      | 報　 |        | で行いません。                   |          |               |                 |
      |      +--------+----------------------------------+----------+---------------+-----------------+
      |      | 周期\  | Git リポジトリとの同期を自動で\  | ー       | 手動入力      | 単位：秒        | 
      |      | (秒)   | 行う周期を入力して下さい。       |          |               |                 |
      |      |        |                                  |          |               |                 |     
      |      |        | 未入力時のデフォルトは60秒です。 |          |               |                 | 
      +------+--------+----------------------------------+----------+---------------+-----------------+
      | 通\  | 回数   | Gitとの通信に失敗した場合、通信\ | ー       | 手動入力      |                 |
      | 信\  |        | をリトライする回数を入力して下さ\|          |               |                 |
      | リ\  |        | い。                             |          |               |                 |
      | ト\  |        | 未入力時のデフォルトは 3 回です。|          |               |                 |
      | ラ\  +--------+----------------------------------+----------+---------------+-----------------+
      | イ\  | 周期\  | Gitとの通信に失敗した場合、通信\ | ー       | 手動入力      | 単位：ms        |
      | 情\  | (ms)   | をリトライする間隔を入力して下さ\|          |               |                 |
      | 報   |        | い。                             |          |               |                 |  
      |      |        | 未入力時のデフォルトは1000msで\  |          |               |                 |             
      |      |        | す。                             |          |               |                 |
      +------+--------+----------------------------------+----------+---------------+-----------------+
      | 備考          | 自由記述\                        | ー       | 手動入力      | 最大長\         |         
      |               | 欄です。                         |          |               | 4000ﾊﾞｲﾄ        |          
      +---------------+----------------------------------+----------+---------------+-----------------+



3. | Gitリポジトリとの同期状態を表示する項目は以下の通りです。


   .. list-table:: 表 4.1-2 Gitリポジトリ同期状態表示項目一覧（リモートリポジトリ)
      :widths: 5 20 5 
      :header-rows: 1
      :align: left
      
      * - 項目
        - 説明
        - 備考
      * - 状態
        - | Gitリポジトリとの同期状態を下記4つの状態で表示します。
          | 空白： レコードの新規登録・更新・廃止からの復活を行った状態
          | 正常： Git リポジトリとの同期が正常に行われている状態
          | 異常： Git リポジトリとの同期で異常が発生した状態
          | 再開： 再開ボタンをクリックした状態
          | 状態が異常になると、Git リポジトリとの同期が停止します。
          | 再開するには、再開ボタンをクリックするか、該当レコードを更新して下さい。
        - | 「6.1 資材をGit リポジトリに登録する場合の注意事項」を参照して下さい。
      * - 詳細情報
        - | 状態が異常になった場合、異常となった原因が表示されます。
          | 再開ボタンをクリックするか、該当レコードを更新すると詳細情報はクリアされます。
        -  
      * - 最終日時
        - | 最後に Git リポジトリと同期を行った日時が表示されます。
          | 再開ボタンをクリックするか、該当レコードを更新すると最終日時はクリアされます。
        -    
      * - 再開ボタン
        - | 状態が異常の場合にボタンが活性化します。
          | 再開ボタンをクリックすると状態が再開になります。 
        -         
 
4. | ssh鍵認証の場合の鍵ファイルについて

   | rootユーザで鍵ファイルを作成し鍵交換して下さい。
   | 秘密鍵ファイル(id_ras)のパスはデフォルト(/root/.ssh/id_ras)を使用して下さい。
   | デフォルト以外にしたい場合、ssh接続情報/接続パラメータに秘密鍵ファイル(id_ras)のパスを設定して下さい。

   | **-i 秘密鍵ファイル(id_ras)のパス**

5. | ITAサーバにリモートリポジトリを作成する場合のGitバージョンに関する注意事項

   | Gitバージョンが1.8.4.3より古い場合、リモートリポジトリに新規ブランチを作成してからコミットするまでの間、リモートリポジトリのHEADブランチ(Defaultbranch)の特定が出来なくなる為、この間にブランチ切り替えを行った場合にブランチ切り替えの検出できません。
   | この事により切り替え先ブランチの資材が「資材紐付」メニューの資材パスに表示されない事があります。
   | ITAサーバにリモートリポジトリを作成する場合のGitバージョンは1.8.4.3以上を使用して下さい。


登録アカウント
~~~~~~~~~~~~~~

1. | 「登録アカウント」メニューでは、ITAのRestAPIから紐付先資材にアクセスする為のアカウント情報を登録します。
   | 登録アカウントに登録するアカウント情報は「管理コンソール/ユーザ管理」メニューに登録しておく必要があります。

   .. {{登録アカウント画像を追加 }}

**図** **4.1-2メニュー画面（登録アカウント）**

2. | 登録アカウント画面の入力項目は以下の通りです。


.. list-table:: 4.1-3 登録アカウント画面入力項目一覧
   :widths: 5 20 5 5 10
   :header-rows: 1
   :align: left

   * - 項目
     - 説明
     - 入力必須
     - 入力景色
     - 制約事項 
   * - ログインID
     - | 「管理コンソール/ユーザ管理」メニューに登録されている、ユーザのログイン ID の一覧が表示されます。
       | RestAPIで使用するユーザのログイン ID を選択します。
     - 〇
     - リスト選択
     -    
   * - ログインPW
     - | ログイン ID で選択したユーザのパスワードを入力します。
       | 「管理コンソール/ユーザ管理」メニューで登録したパスワードを入力します。 
     - 〇
     - 手動入力
     - 最大長128バイト
   * - 備考
     - 自由記述欄です。
     - ー
     - 手動入力
     - 最大長4000バイト 


資材紐付
~~~~~~~~

1. | 「資材紐付」メニューでは、紐付元資材と紐付先資材を紐付し、紐付先資材の動作検証を行う為のオペレーションとMovementを登録します。
   | 紐付元資材が更新されると、バックヤード機能で紐付先資材を自動更新し、動作検証を行う為のオペレーションとMovementで作業実行を行い、処理結果が表示されます。

   .. {{ 資材紐付の画像を追加 }}

**図** **4.1-3 メニュー画面（資材紐付）**

2. | 資材紐付画面の入力項目は以下の通りです。

   .. table:: 表 4.1-4 資材紐付画面入力 項目一覧（資材紐付）
      :widths: 8 8 8 25 12 12 12
      :align: left    

      +---------------+---------------------------------------------------+----------+---------------+-----------------+
      | **項目**      | **説明**                                          | **入力\  | **入\         | **制\           |          
      |               |                                                   | 必須**   | 力形式**      | 約事項**        |          
      +===============+===================================================+==========+===============+=================+
      | 紐付先資材名  | 紐付先資材に登録されている資材名\                 | 〇       | 手動入力      | 最大長256バイト | 
      |               | を入力してください。                              |          |               |                 |
      |               | この名前は、紐付先資材タイプに\                   |          |               |                 |       
      |               | より、下記メニューの項目に紐付け\                 |          |               |                 |
      |               | ます。                                            |          |               |                 |               
      |               | 各メニューの項目と同等の入力規則\                 |          |               |                 |    
      |               | があります。各項目の入力規則に\                   |          |               |                 |
      |               | 従い、資材名を入力してください。                  |          |               |                 |
      |               |                                                   |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | メニュー名           | 項目名            |      |          |               |                 |
      |               | +======================+===================+      |          |               |                 |
      |               | | Ansible-Legacy/Play\ | Paybook 素材名    |      |          |               |                 |    
      |               | | book 素材集          |                   |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Ansible-Pioneer/対話\| 対象項目なし      |      |          |               |                 |
      |               | | ファイル素材集       |                   |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Ansible-LegacyRole\  | ロールパッケージ名|      |          |               |                 |   
      |               | | /ロールパッケージ管理|                   |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Ansible 共通/ファイ\ | ファイル埋込変数\ |      |          |               |                 |
      |               | | ル管理               | 名                |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Ansible 共通/テンプ\ | ﾃﾝﾌﾟﾚｰﾄ埋込変数名 |      |          |               |                 |   
      |               | | レート管理           |                   |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Terraform/Module\    |  Module 素材名    |      |          |               |                 |
      |               | | 素材集               |                   |      |          |               |                 |               
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Terraform/Policy 管理| Policy 名         |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               | | Terraform-CLI/Module\| Module 素材名     |      |          |               |                 |      
      |               | | 素材集               |                   |      |          |               |                 |
      |               | +----------------------+-------------------+      |          |               |                 |
      |               |                                                   |          |               |                 |
      |               | 紐付先資材名に入力した資材名の登録有無等の条件に\ |          |               |                 | 
      |               | より紐付処理が異なります。                        |          |               |                 | 
      |               | 詳細は「(4)紐付先資材の更新処理の流れ」を参照して\|          |               |                 |
      |               | ください。                                        |          |               |                 |  
      |               |                                                   |          |               |                 | 
      |               | また、紐付先資材名を変更する場合、「(5)紐付先資材\|          |               |                 |    
      |               | 名を変更する場合の注意事項」を参照して下さい。    |          |               |                 |
      +----+----------+---------------------------------------------------+----------+---------------+-----------------+ 
      | Gi\| リモート\| 「4.1.1 リモートリポジトリ」メニューに登録されて\ | 〇       | リスト選択    |                 |
      | t\ | リポジト\| いるリモートリポジトリが一覧で表示されます。      |          |               |                 | 
      | リ\| リ       |                                                   |          |               |                 |            
      | ポ\|          | 紐付元となる資材が含まれいているリモートリポジト\ |          |               |                 |
      | ジ\|          | リを選択してください。                            |          |               |                 |
      | ト\+----------+---------------------------------------------------+----------+---------------+-----------------+
      | リ\| 資材パス | 紐付元資材が一覧で表示されます。紐付元資材となる\ | 〇       | リスト選択    |                 |           
      | (F\|          | 資材パスを選択してください。                      |          |               |                 | 
      | ro |          |                                                   |          |               |                 |     
      | m) |          | 紐付先資材タイプが「Ansible-LegacyRole/ロールパッ\|          |               |                 |    
      |    |          | ケージ管理」メニューの場合、「6.2 ロールパッケー\ |          |               |                 |
      |    |          | ジ管理に紐付する資材をGitリポジトリに登録する場合\|          |               |                 |
      |    |          | の注意事項」を参照してください。                  |          |               |                 |  
      +----+----------+---------------------------------------------------+----------+---------------+-----------------+
      | Ex\| 紐付先資\| 紐付先資材タイプ（メニュー）を選択して下さい。    | 〇       | リスト選択    |                 |
      | as\| 材タイプ | 紐付先資材は下記のメニューから選択できます。      |          |               |                 |
      | tr\|          | 各メニューを選択するには、各メニューに対応した\   |          |               |                 |  
      | o \|          | ドライバがインストールされている必要があります。  |          |               |                 |
      | IT |          |                                                   |          |               |                 |
      | au\|          | +-------------------------+-------------------+   |          |               |                 |
      | tm\|          | | メニュー名              | インストールが必\ |   |          |               |                 |
      | at\|          | +=========================+===================+   |          |               |                 |
      | io\|          | | Ansible-Legacy/Playbook\| Ansible-Driver    |   |          |               |                 |  
      | n \|          | | 素材集                  |                   |   |          |               |                 |
      | (T\|          | +-------------------------+                   |   |          |               |                 |
      | o) |          | | Ansible-Pioneer/対話フ\ |                   |   |          |               |                 |
      |    |          | | ァイル素材集            |                   |   |          |               |                 |
      |    |          | +-------------------------+                   |   |          |               |                 |
      |    |          | | Ansible-LegacyRole/ロー\|                   |   |          |               |                 | 
      |    |          | | ルパッケージ管理        |                   |   |          |               |                 | 
      |    |          | +-------------------------+                   |   |          |               |                 |
      |    |          | | Ansible 共通/ファイル管\|                   |   |          |               |                 |  
      |    |          | | 理                      |                   |   |          |               |                 |
      |    |          | +-------------------------+                   |   |          |               |                 |
      |    |          | | Ansible 共通/テンプレー\|                   |   |          |               |                 |  
      |    |          | | ト管理                  |                   |   |          |               |                 |
      |    |          | +-------------------------+-------------------+   |          |               |                 |
      |    |          | | Terraform/Module 素材集 | Terraform-Driver  |   |          |               |                 |
      |    |          | +-------------------------+                   |   |          |               |                 |
      |    |          | | Terraform/Policy 管理   |                   |   |          |               |                 |
      |    |          | +-------------------------+-------------------+   |          |               |                 |
      |    |          | | Terraform-CLI/Module\   | Terraform-CLI-Dri\|   |          |               |                 |  
      |    |          | | 素材集                  | ver               |   |          |               |                 |
      |    |          | +-------------------------+-------------------+   |          |               |                 |
      |    |          |                                                   |          |               |                 |
      |    +----+-----+---------------------------------------------------+----------+---------------+-----------------+    
      |    | テ\| 変\ | 紐付先資材タイプで「Ansible 共通/テンプレート管\  | ー       | 手動入力      | 最大長8192バイト|  
      |    | ン\| 数\ | 理」メニューを選択した場合、資材に必要な変数定義\ |          |               |                 |
      |    | プ\| 管理| を入力して下さい。                                |          |               |                 | 
      |    | レ\|     | 「Ansible 共通/テンプレート管理」メニュー以外を\  |          |               |                 | 
      |    | ー\|     | 選択している場合は入力不要です。                  |          |               |                 | 
      |    | ト\|     |                                                   |          |               |                 |  
      |    | 管\|     |                                                   |          |               |                 | 
      |    | 理 |     |                                                   |          |               |                 |
      |    +----+-----+---------------------------------------------------+----------+---------------+-----------------+
      |    | An\| 対\ | 「Ansible-Pioneer/対話種別」メニューに登録されて\ | ー       | リスト選択    |                 |
      |    | si\| 話\ | いる対話種別が一覧に表示されます。                |          |               |                 |
      |    | bl\| 種\ | 紐付先資材タイプで「Ansible-Pioneer/対話ファイル\ |          |               |                 |  
      |    | e-\| 別  | 素材集」メニューを選択した場合、紐付先資材の対話\ |          |               |                 | 
      |    | Pi\|     | 種別を一覧より選択して下さい。                    |          |               |                 | 
      |    | on\|     | 紐付先資材タイプで「Ansible-Pioneer/対話ファイル\ |          |               |                 |
      |    | eer|     | 素材集」メニュー以外を選択している場合は選択不要\ |          |               |                 |
      |    |    |     | です。                                            |          |               |                 |
      |    |    +-----+---------------------------------------------------+----------+---------------+-----------------+
      |    |    | OS\ | 「Ansible-Pioneer/OS 種別」メニューに登録されてい\| ー       | リスト選択    |                 |
      |    |    | 種別| るOS種別が一覧に表示されます。                    |          |               |                 |
      |    |    |     | 紐付先資材タイプで「Ansible-Pioneer/対話ファイル\ |          |               |                 |
      |    |    |     | 素材集」メニューを選択した場合、紐付先資材のOS種\ |          |               |                 |
      |    |    |     | 別を一覧より選択して下さい。                      |          |               |                 |
      |    |    |     | 紐付先資材タイプで「Ansible-Pioneer/対話ファイル\ |          |               |                 |
      |    |    |     | 素材集」メニュー以外を選択している場合は選択不要\ |          |               |                 |
      |    |    |     | です。                                            |          |               |                 |
      |    +----+-----+---------------------------------------------------+----------+---------------+-----------------+
      |    | 実行ログ\| 「4.1.2 登録アカウント」メニューに登録されている\ | 〇       | リスト選択    |                 |
      |    | ID       | ユーザのログイン ID の一覧が表示されます。RestAPI\|          |               |                 | 
      |    |          | から紐付先資材にアクセス。又は作業実行する為のロ\ |          |               |                 |
      |    |          | グインIDを選択して下さい。                        |          |               |                 |  
      |    |          |                                                   |          |               |                 |   
      |    |          | 「紐付先資材タイプ」で指定したメニューに対して、\ |          |               |                 |
      |    |          | 「管理コンソール/ロール・メニュー紐付管理」メニ\  |          |               |                 |
      |    |          | ューの「紐付」が「メンテナンス可」のロールに所属\ |          |               |                 |
      |    |          | しているユーザのログインIDを選択する必要がありま\ |          |               |                 |
      |    |          | す。                                              |          |               |                 |
      |    +----------+---------------------------------------------------+----------+---------------+-----------------+
      |    | アクセス\| 紐付先資材のレコードを追加・更新した場合、アクセ\ | ー　     | リスト選択    |                 |
      |    | 許可ロー\| ス許可ロールの設定内容を選択します。              |          |               |                 |
      |    | ル       |                                                   |          |               |                 |
      |    |          | なし：空白（アクセス許可ロールなし）              |          |               |                 |
      |    |          |                                                   |          |               |                 |     
      |    |          | あり：「実行ログイン ID」に対して「管理コンソー\  |          |               |                 |
      |    |          | ル/ロール・ユーザ紐付管理」メニューで紐付けている\|          |               |                 | 
      |    |          | ロールの内、「デフォルトアクセス権」が設定されて\ |          |               |                 |
      |    |          | いるロールをアクセス許可ロールに設定します。      |          |               |                 |  
      |    |          | 「デフォルトアクセス権」が設定されているロールが\ |          |               |                 | 
      |    |          | 無い場合、アクセス許可ロールは空白が設定されます。|          |               |                 | 
      |    |          |                                                   |          |               |                 | 
      |    |          | 未選択時のデフォルトは「なし」です。              |          |               |                 |
      +----+----------+---------------------------------------------------+----------+---------------+-----------------+
      | 素\| 自動同期 | Git リポジトリの資材が更新された場合に紐付先資材\ | 〇       | リスト選択    | 初期値：有効    |
      | 材\|          | の更新を自動で行うかを選択して下さい。            |          |               |                 |
      | 同\|          |                                                   |          |               |                 | 
      | 期\|          | 有効：Git リポジトリの資材が更新された場合、紐付\ |          |               |                 |
      | 情\|          | 先資材の更新を自動で行います。                    |          |               |                 |
      | 報 |          |                                                   |          |               |                 |
      |    |          | 無効：Git リポジトリの資材が更新されても紐付先資\ |          |               |                 |
      |    |          | 材の更新を行いません。                            |          |               |                 |
      +----+----------+---------------------------------------------------+----------+---------------+-----------------+
      | デ\| オペレー\| 「基本コンソール/投入オペレーション一覧」メニュー\| ー       | リスト選択    |                 |
      | リ\| ション   | に登録されているオペレーションの一覧が表示されま\ |          |               |                 | 
      | バ\|          | す。                                              |          |               |                 | 
      | リ\|          |                                                   |          |               |                 |
      | 情\|          | 紐付先資材を更新した場合に、Movemnet を実行するオ\|          |               |                 | 
      | 報 |          | ペレーションを選択します。                        |          |               |                 |
      |    +----------+---------------------------------------------------+----------+---------------+-----------------+
      |    | Movement | 「基本コンソール/Movement 一覧」メニューに登録さ\ | ー       | リスト選択    |                 |
      |    |          | れているMovement の一覧が表示されます。           |          |               |                 |
      |    |          |                                                   |          |               |                 |
      |    |          | 紐付先資材を更新した場合に、実行する Movementを選\|          |               |                 |
      |    |          | 択します。                                        |          |               |                 |
      |    +----------+---------------------------------------------------+----------+---------------+-----------------+
      |    | ドライラ\| Movement を実行するモードを選択します。           | ー       | リスト選択    |                 |     
      |    | ン       |                                                   |          |               |                 |
      |    |          | ●:を選択した場合、ドライランモードでMovementを\   |          |               |                 |
      |    |          | 実行します。                                      |          |               |                 | 
      |    |          |                                                   |          |               |                 |
      |    |          | 未選択時はドライランモードでは実行しません。      |          |               |                 |
      +----+----------+---------------------------------------------------+----------+---------------+-----------------+  
      | 備考          | 自由記述欄です。                                  | ー       | 手動入力      | 最大長4000バイト|
      +---------------+---------------------------------------------------+----------+---------------+-----------------+                                              


3. | Gitリポジトリの資材と紐付先資材との同期の状態を表示する項目は以下の通りです。
  
   .. table:: 表 4.1-5 資材紐付状態表示項目一覧 (資材紐付)

      +-------------------------+---------------------------------------------------+-------------+
      | **項目**                | **説明**                                          | **備考**    |       
      +======+==================+===================================================+=============+
      | 資材\| 状態             | 紐付元資材と紐付先資材の同期状態を下記4つの状態で\|             |
      | 同期\|                  | 表示します。                                      |             |      
      | 情報 |                  |                                                   |             | 
      |      |                  | 空白： レコードの新規登録・更新・廃止からの復活を\|             |
      |      |                  | 行った状態。                                      |             |
      |      |                  |                                                   |             |
      |      |                  | 正常： 紐付元資材と紐付先資材の同期が正常に行われ\|             |
      |      |                  | ている状態                                        |             |
      |      |                  |                                                   |             |
      |      |                  | 異常： 以下の2通りの状態が考えられます。          |             |
      |      |                  |                                                   |             |  
      |      |                  | ・紐付元資材と紐付先資材の同期で異常が発生した状\ |             |
      |      |                  | 態                                                |             |
      |      |                  |                                                   |             |
      |      |                  | ・紐付先資材の更新により、設定されているオペレー\ |             |
      |      |                  | ションとMovementで作業実行をしたが作業実行が出来\ |             | 
      |      |                  | なかった状態※1                                    |             |
      |      |                  |                                                   |             |
      |      |                  | 再開： 再開ボタンをクリックした状態               |             |
      |      |                  |                                                   |             |
      |      |                  | 状態が異常になると、紐付元資材と紐付先資材の同期\ |             |
      |      |                  | が停止します。再開するには、再開ボタンをクリック\ |             |
      |      |                  | するか、該当レコードを更新して下さい。            |             |
      |      +------------------+---------------------------------------------------+-------------+         
      |      | 詳細情報         | 紐付元資材と紐付先資材の同期状態が異常になった場\ |             |
      |      |                  | 合、異常となった原因が表示されます。              |             |
      |      |                  |                                                   |             |  
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると詳細情報はクリアされます。                    |             |
      |      +------------------+---------------------------------------------------+-------------+
      |      | 最終日時         | 最後に紐付元資材と紐付先資材の同期を行った日時が\ |             |
      |      |                  | 表示されます。                                    |             |
      |      |                  |                                                   |             |    
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると最終日時はクリアされます。                    |             |
      |      +------------------+---------------------------------------------------+-------------+
      |      | 最終実行ログイン\| 最後に紐付元資材と紐付先資材の同期を行ったログイ\ |             |
      |      | ID               | ンID が表示されます。                             |             |
      |      |                  |                                                   |             |
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると最終実行ログインIDはクリアされます。          |             |
      |      +------------------+---------------------------------------------------+-------------+
      |      | 再開ボタン       | 状態が異常の場合にボタンが活性します。            |             |
      |      |                  |                                                   |             |
      |      |                  | 再開ボタンをクリックすると状態が再開になります。  |             |
      +------+------------------+---------------------------------------------------+-------------+ 
      | デリ\| 詳細情報         | 紐付先資材の更新により、設定されているオペレーシ\ |             |
      | バリ\|                  | ョンと Movement で作業実行をしたが作業実行が出来\ |             |
      | 情報 |                  | なかった場合、実行出来なかったエラー原因が表示さ\ |             |
      |      |                  | れます。※1                                        |             |
      |      |                  |                                                   |             |
      |      |                  | 尚、作業実行が実行できた場合、実行結果が異常かど\ |             |
      |      |                  | うかの判定※2 はしていません。                     |             |
      |      |                  | 作業状態確認ボタンをクリックし「各ドライバ/作業状\|             |
      |      |                  | 態確認」メニューより実行結果を確認して下さい。    |             |
      |      |                  |                                                   |             |
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると詳細情報はクリアされます。                    |             |
      |      +------------------+---------------------------------------------------+-------------+
      |      | 作業インスンスNo | オペレーションと Movement で作業実行が実行できた\ |             |
      |      |                  | 場合、作業実行の作業インスタンス No が表示されま\ |             |
      |      |                  | す。                                              |             | 
      |      |                  |                                                   |             |
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると作業インスタンス No はクリアされます。        |             |
      |      +------------------+---------------------------------------------------+-------------+   
      |      | 作業状態確認\    | オペレーションと Movement で作業実行が実行できた\ |             |
      |      | ボタン           | 場合、作業状態確認ボタンが活性します。            |             |
      |      |                  |                                                   |             |
      |      |                  | 作業状態確認ボタンをクリックすると、「各ドライバ/\|             | 
      |      |                  | 作業状態確認」メニューが表示され、作業実行の状態\ |             |
      |      |                  | を確認する事が出来ます。                          |             |
      |      |                  |                                                   |             |
      |      |                  | 「作業状態確認」の詳細については各ドライバの\     |             |
      |      |                  | 「利用手順マニュアル」を参照してください。        |             | 
      |      |                  |                                                   |             |
      |      |                  | 再開ボタンをクリックするか、該当レコードを更新す\ |             |
      |      |                  | ると作業状態確認ボタンは非活性になります。        |             |
      +------+------------------+---------------------------------------------------+-------------+



| ※1 オペレーションやMovementが廃止されている場合など。
| ※2 紐付先資材に誤りがあった場合や、作業実行に必要な情報が不足している場合など。

4. | 紐付先資材の更新処理の流れ


   .. image:: /images/ja/cicd_for_iac/CICD_flow2.png
      :width: 6.68819in
      :height: 3.35972in

| ※1 紐付先資材タイプが「Ansible-Pioneer/対話ファイル素材集」の場合、紐付先資材名は対話種別とOS種別の組み合わせになります。
| ※2 作業実行に必要な情報が不足している場合、作業実行が失敗する場合があります。
| ※3 項目の差分は、アクセス許可ロールと備考も含まれます。また、備考については常に空白で更新されます。
| ※4「4.1.3資材紐付」メニューの「資材同期情報->状態」に「異常」、「資材同期情報->詳細情報」にエラー原因を設定します。
| ※5 「4.1.3資材紐付」メニューの「資材同期情報->状態」に「異常」、「デリバリ情報->詳細情報」にエラー原因を設定します。
| ※6 「4.1.3資材紐付」メニューの「資材同期情報->状態」に「正常」を設定します。


5. | 紐付先資材名を変更する場合の注意事項
   | 紐付先資材名を変更した場合、紐付先資材の変更前のレコードはそのまま残り、変更後の紐付先資材名で新しいレコードが作成されます。


CI/CD For IaC 非表示メニュー
----------------------------

| 本節では、CI/CD For IaC機能をインストールした状態では表示されないメニューの操作について記載します。
| 各メニューにアクセスするには、「管理コンソール/ロール・メニュー紐付管理」で各メニューを復活処理を行うことによって表示されるようになります。
| 詳細は「利用手順マニュアル_管理コンソール」を参照してください。

.. _interfaceinformation:

インターフェース情報
~~~~~~~~~~~~~~~~~~~~

1. | 「インターフェース情報」メニューには、ITAのRestAPIから紐付先資材にアクセスする為のインターフェース情報を登録します。
   | デフォルトは、インストール先のＩＴＡにアクセスする為のインターフェース情報が登録されています。
   | 紐付先資材をインストール先のＩＴＡ以外にしたい場合に、インターフェース情報を変更して下さい。



**図** **4.2-1メニュー画面（インタフェース情報）**

2. | インターフェース情報画面の入力項目は以下の通りです。

   .. table:: 表4.2-1 インターフェース情報  画面入力項目一覧（インタフェース情報）

      +------------+--------------+----------+--------------+--------------+
      | **項目**   | **説明**     | **入力** | **入力形式** | **制約事項** |
      |            |              |          |              |              |
      |            |              | **必須** |              |              |
      +============+==============+==========+==============+==============+
      | ホスト名   | I\           | ○        | 手動入力     | 最\          |
      |            | TAサーバのホ\|          |              | 大長128ﾊﾞｲﾄ  |
      |            | スト名または\|          |              | 初期値:      |
      |            | IPアドレスを\|          |              | 127.0.0.1    |
      |            | 入力します。 |          |              |              |
      +------------+--------------+----------+--------------+--------------+
      | プロトコル | I\           | ○        | 手動入力     | 初期値: http |
      |            | TAサーバとの\|          |              |              |
      |            | プロトコル(h\|          |              |              |
      |            | ttp/https)を\|          |              |              |
      |            | 入力します。 |          |              |              |
      +------------+--------------+----------+--------------+--------------+
      | ポート     | ITAサー\     | ○        | 手動入力     | 初期値: 80   |
      |            | バの接続ポー\|          |              |              |
      |            | ト(80/443)を\|          |              |              |
      |            | 入力します。 |          |              |              |
      +------------+--------------+----------+--------------+--------------+
      | 備考       | 自由\        | ー       | 手動入力     | 最\          |
      |            | 記述欄です。 |          |              | 大長4000ﾊﾞｲﾄ |
      +------------+--------------+----------+--------------+--------------+


リモートリポジトリ資材
~~~~~~~~~~~~~~~~~~~~~~

1. | 「リモートリポジトリ資材」メニューには、紐付元資材の一覧が表示されます。
    
   | 「リモートリポジトリ資材」メニューに表示される情報はバックヤード機能で更新しています。
   | レコード追加・更新・削除は行わないで下さい。


図 4.2-2メニュー画面（リモートリポジトリ資材）


2. | リモートリポジトリ資材画面の表示項目は以下の通りです。

   .. table:: 表 4.2-2 リモートリポジトリ資材表示 項目一覧（リモートリポジトリ資材）

      +---------------+---------------+--------+------------+---------------+
      | **項目**      | **説明**      | **入力\| **入力\    | **制約事項**  |
      |               |               | 必須** | 形式**     |               |
      +===============+===============+========+============+===============+
      | リモート\     | 「4.1.1リ\    | ○      | リスト選択 |               |
      | リポジトリ名  | モートリポジ\ |        |            |               |
      |               | トリ」メニュ\ |        |            |               |
      |               | ーで登録した\ |        |            |               |
      |               | リモートリポ\ |        |            |               |
      |               | ジトリ名が表\ |        |            |               |
      |               | 示されます。  |        |            |               |
      +---------------+---------------+--------+------------+---------------+
      | 資材パス      | 紐付元資材の\ | ○      | リスト選択 | 最\           |
      |               | 資材パスが表\ |        |            | 大長4096ﾊﾞｲﾄ  |
      |               | 示されます。  |        |            |               |
      |               |               |        |            |               | 
      |               | 「4.1.1リモー\|        |            |               |
      |               | トリポジトリ\ |        |            |               |
      |               | 」メニューの\ |        |            |               |
      |               | 「同期状態」\ |        |            |               |
      |               | が「異常」が\ |        |            |               |
      |               | 設定されてい\ |        |            |               |
      |               | るリモートリ\ |        |            |               |
      |               | ポジトリの資\ |        |            |               |
      |               | 材パスは表示\ |        |            |               |
      |               | されません。  |        |            |               |
      +---------------+---------------+--------+------------+---------------+
 

運用操作
========

| 本機能を活用する操作は、クライアントPCのブラウザ画面からのユーザ利用による入力だけでなく、システム運用・保守による操作もあります。
| 用意している運用・保守の操作は次のとおりです。

| ■ メンテナンス
| ■ ログレベルの変更


メンテナンス方法について
------------------------

| CICD For IaC機能のプロセスの開始/停止/再起動に必要なファイルは以下となります。

.. table:: CICD機能のプロセスの開始/停止/再起動に必要なファイル

   +----------------------------------+----------------------------------+
   | **説明**                         | **対象ファイル名**               |
   +==================================+==================================+
   | CICD For IaC機能                 | ky_CICD_for_IaC\                 |
   |                                  | git_synchronize-workflow.service |
   | 「4.1.1リモートリポジトリ\       |                                  |
   | 」に登録されているGitリポジトリ\ |                                  |
   | のローカルクローンを作成する。※1 |                                  |
   |                                  |                                  |
   | 「4.1.3資材紐付」で紐付\         |                                  |
   | けられている紐付先資材を自動更新\|                                  |
   | し、動作検証を行う為のオペレーシ\|                                  |
   | ョンとMovementで作業実行を行う。 |                                  |
   +----------------------------------+----------------------------------+


| ※1  Gitリポジトリのローカルクローンのパスは/「ITAインストールディレクトリ」/ita-root/repositorys/000000000x
| (x:「4.1.1リモートリポジトリ」の項番 右詰10桁)になります。


| 対象ファイルは「/usr/lib/systemd/system」に格納されています。
| プロセス起動/停止/再起動の方法は次の通りです。
| root権限でコマンドを実行してください。

.. code-block:: bash 

  #  systemctl start ky_CICD_for_IaC_git_synchronize-workflow.service 

| ②プロセス停止

.. code-block:: bash 

   #  systemctl stop ky_CICD_for_IaC_git_synchronize-workflow.service

| ③プロセス再起動

.. code-block:: bash 

   # systemctl restart ky_CICD_for_IaC_git_synchronize-workflow.service 

| 各対象ファイル名に置き換えて起動/停止/再起動を行ってください。

ログレベルの変更
----------------

| ①　NORMALレベルへの変更
| 以下のファイルの8行目「DEBUG」を「NORMAL」に書き換えます。
| ログレベル設定ファイル：
| :file:`<インストールディレクトリ>/ita-root/confs/backyardconfs/ita_env`

| ②　DEBUGレベルへの変更
| 以下のファイルの8行目「NORMAL」を「DEBUG」に書き換えます。
| ログレベル設定ファイル：
| :file:`<インストールディレクトリ>/ita-root/confs/backyardconfs/ita_env`


| 書き換え後、\ **プロセス再起動(restart)後に有効になります。**
| ログファイルの出力先 :
| :file:`<インストールディレクトリ>/ita-root/logs/backyardlogs`


付録
====


資材をGitリポジトリに登録する場合の注意事項
-------------------------------------------

| 資材をGitリポジトリに登録する場合の注意事項を以下に記述します。

#. | 255ﾊﾞｲﾄ以上の資材名が含まれるGitリポジトリを「4.1.1リモートリポジトリ」メニューに登録すると、Gitclone commandが異常終了します。

#. | ファイルパスも含めて4096ﾊﾞｲﾄ以上の資材名が含まれるGitリポジトリを「4.1.1リモートリポジトリ」メニューに登録すると、Gitclone commandが異常終了します。


ロールパッケージ管理に紐付する資材をGitリポジトリに登録する場合の注意事項
-------------------------------------------------------------------------

| 「Ansible-LegacyRole/ロールパッケージ管理」メニューに紐付する資材をGitリポジトリに登録する場合の注意事項を以下に記述します。

#. | rolesという名前のディレクトリを含むディレクトリを作成し、この配下にロールパッケージに必要なファイル・ディレクトリを配置して下さい。
   | ロールパッケージとしてzipで固められる資材は、rolesディレクトリの上位ディレクトリ配下になります。ただし、Gitリポジトリのルートディレクトリ直下にrolesという名前のディレクトリを作成しても、「Ansible-LegacyRole/ロールパッケージ管理」メニューに紐付するrolesディレクトリとして認識しません。

   | <Exp>
   | 以下のようなファイル・ディレクトリ構成の場合、「sample/roles」はrolesディレクトリとして認識しますが、「roles」はrolesディレクトリとして認識しません。

   | Gitリポジトリのルートディレクトリ


   .. code-block:: bash
     :caption: Gitリポジトリのルートディレクトリ

     |-  roles          ・・・・・・・roles ディレクトリとして認識しません。
     |   |  ita_readme_test_role.yml
     |   |  ita_translation-table_test_role.txt 
     |   |- test_role
     |      |-  defaults
     |      |     main.yml
     |      |-  tasks
     |            main.yml
     |
     |- sample
         | ita_readme_test_role.yml
         | ita_translation-table_test_role.txt
         |- roles       ・・・・・・・roles ディレクトリとして認識します。
             |- test_role
                |- defaults
                |     main.yml
                |- tasks
                      main.yml

  
                            
| 「4.1.3資材紐付」メニューの資材パスに「sample/roles」が表示されます。「Ansible-LegacyRole/ロールパッケージ管理」メニューに紐付ける資材パスには、「sample/roles」を選択して下さい。

.. 2系紐づけ画像を入れる