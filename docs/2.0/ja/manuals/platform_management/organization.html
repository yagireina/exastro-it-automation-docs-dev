
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>1. Organization (オーガナイゼーション) &#8212; Documentation  ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/option.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/exastro_documents.css?v=2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/swagger/swagger-ui.css" />
    
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/translations.js"></script>
    <script src="../../../../_static/jquery-3.6.3.min.js"></script>
    <script src="../../../../_static/exastro_documents.js?v=1"></script>
    <script src="../../../../_static/swagger/swagger-ui-bundle.js"></script>
    <script src="../../../../_static/swagger/swagger-ui-standalone-preset.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" />
    <link rel="next" title="2. リソースプラン" href="plan.html" />
    <link rel="prev" title="システム管理" href="index.html" /> 
  </head>
<body id="page" class="ja">


<div id="container">

<div id="header">
  <header class="divInner">
    <!-- Exastro logo -->
    <div id="logo"><a href="https://ita.exastro.org/"><img src="../../../../_static/img/exastro.svg" alt="Exastro"></a></div>
    <!-- Project name -->
    <div id="projectName"><a href="../../../../index.html">Documentation</a></div>
    <!-- Heaedr navigation -->
    <div id="headerSearch">
      <form class="search" action="../../../../search.html" method="get">
        <input type="text" name="q" aria-labelledby="searchlabel">
        <button type="submit" value="検索"><img src="../../../../_static/img/search.png" alt="検索"></button>
      </form>
    </div>
  </header>
</div><!-- End #header -->


<div id="toolbar">
  <div class="divInner">
    
    <div id="documentVersion">
      <dl>
        <dt>Document version</dt>
        <dd>
          <div>
            <select name="version" onchange="location.href=value;">
                file_path: 2.0/ja/manuals/platform_management/organization
                  <option value="#"
                  selected
                  >current</option>
                file_path: 2.0/ja/manuals/platform_management/organization
                  <option value="#"
                  selected
                  >2.0 (current)</option>
                file_path: 2.1/ja/manuals/platform_management/organization
            </select>
          </div>
        </dd>
      </dl>
    </div>

    <div id="documentLanguage">
      <dl>
        <dt>Language</dt>
        <dd>
          <div>
            <select name="lang" onchange="location.href=value;">
                file_path: 2.0/ja/manuals/platform_management/organization
                hasdoc: True
                  <option value="#"
                  selected
                  >日本語</option>
                file_path: 2.0/en/manuals/platform_management/organization
                hasdoc: False
            </select>
          </div>
        </dd>
      </dl>
    </div>
    <div id="toolbarNavigation">
      <ul>
        <li class="prev"><a href="index.html" title="前のトピックへ">システム管理</a></li>
        <li class="next"><a href="plan.html" title="次のトピックへ"><span class="section-number">2. </span>リソースプラン</a></li>
      </ul>
    </div>
  </div>
</div><!-- End #toolbar -->

<div id="sideMenu">

  <div id="menuButton"></div>
  
  <aside class="divInner">
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Exastro IT Automation Documentation 2.0</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html#id1">日本語</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../configuration/index.html">構成・構築ガイド</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation/index.html">インストール</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">マニュアル</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html">システム管理</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">1. Organization (オーガナイゼーション)</a></li>
<li class="toctree-l5"><a class="reference internal" href="plan.html">2. リソースプラン</a></li>
<li class="toctree-l5"><a class="reference internal" href="aap.html">3. Ansible Automation Platform 連携</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../organization_management/index.html">オーガナイゼーション管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../it_automation_base/index.html">基本操作</a></li>
<li class="toctree-l4"><a class="reference internal" href="../create_param/index.html">パラメータ管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ansible-driver/index.html">Ansible ドライバ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maintenance/index.html">メンテナンス</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/index.html">リファレンス</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contribute/index.html">貢献</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    <!-- <ul>
      <li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">索引</a></li>
    </ul> -->
    
  </aside>
</div><!-- End #sideMenu -->


<div id="tableOfContents">
  <div id="tocButton"></div>
  <ul>
<li><a class="reference internal" href="#">1. Organization (オーガナイゼーション)</a><ul>
<li><a class="reference internal" href="#id1">1.1. はじめに</a></li>
<li><a class="reference internal" href="#id2">1.2. オーガナイゼーションとは</a></li>
<li><a class="reference internal" href="#id3">1.3. オーガナイゼーションの作成</a><ul>
<li><a class="reference internal" href="#id4">1.3.1. 目的</a></li>
<li><a class="reference internal" href="#id5">1.3.2. 前提条件</a></li>
<li><a class="reference internal" href="#organization-creation">1.3.3. オーガナイゼーション作成</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">1.4. オーガナイゼーションへのアクセス</a></li>
<li><a class="reference internal" href="#id8">1.5. その他制約事項・備考</a><ul>
<li><a class="reference internal" href="#id">1.5.1. オーガナイゼーションIDの予約語</a></li>
<li><a class="reference internal" href="#id9">1.5.2. オーガナイゼーション作成を再実行する場合</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>


<div id="contents">
<main class="divInner">

 <div id="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">HOME</a></li>
    <li><a href="../../../index.html">Exastro IT Automation Documentation 2.0</a></li>
    <li><a href="../index.html">マニュアル</a></li>
    <li><a href="index.html">システム管理</a></li>
    
    <li><span class="section-number">1. </span>Organization (オーガナイゼーション)</li>
  </ul>
</div>

<div id="article">
<article class="divInner">
<div class="body" role="main">

  <section id="organization">
<h1><span class="section-number">1. </span>Organization (オーガナイゼーション)<a class="headerlink" href="#organization" title="この見出しへのパーマリンク">¶</a></h1>
<section id="id1">
<h2><span class="section-number">1.1. </span>はじめに<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本書では、Exastro Suite における Organization (オーガナイゼーション) について説明します。</div>
</div>
</section>
<section id="id2">
<h2><span class="section-number">1.2. </span>オーガナイゼーションとは<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">Exastro IT Automation 2.0 から導入されたマルチテナント機能におけるテナントの単位のことで、論理的に組織の空間を区分する単位のことで、たとえ同一の Exastro システムであってもデータの共有がされることのない、完全にプライベートな空間です。</div>
<div class="line">Exastro Suite の各アプリケーションの利用を開始するためには、オーガナイゼーションを作成する必要があります。</div>
</div>
<figure class="align-default">
<img alt="オーガナイゼーション全体図" src="../../../../_images/overview_of_the_organization.png" />
</figure>
</section>
<section id="id3">
<h2><span class="section-number">1.3. </span>オーガナイゼーションの作成<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">オーガナイゼーションの作成方法について説明します。</div>
</div>
<section id="id4">
<h3><span class="section-number">1.3.1. </span>目的<a class="headerlink" href="#id4" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">オーガナイゼーション作成を行うことで、オーガナイゼーション管理者のアカウントが作成され、オーガナイゼーションごとのエンドポイントURLにアクセスすることができるようになります。</div>
<div class="line">また、システム内部では下記の処理が実行されます。</div>
</div>
<ul class="simple">
<li><p>処理のながれ</p>
<ol class="arabic simple">
<li><p>Keycloak に、オーガナイゼーション用のレルムデータと管理者ユーザが登録されます。</p></li>
<li><p>MariaDB や MySQL といったリレーショナルデータベースに、オーガナイゼーション用のデータが登録されます。</p></li>
<li><p>Exastro IT Automation の永続ボリュームに、オーガナイゼーション用のディレクトリが作成されます。</p></li>
<li><p>GitLab に、オーガナイゼーション用のユーザが登録されます。</p></li>
</ol>
</li>
</ul>
</section>
<section id="id5">
<h3><span class="section-number">1.3.2. </span>前提条件<a class="headerlink" href="#id5" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">本作業には下記のコマンドが必要となるため、事前にインストールをしてください。</div>
</div>
<ul class="simple">
<li><p>前提条件</p>
<ul>
<li><p>インストールが完了し、Keycloak の管理コンソールにログインできること</p></li>
<li><p>システム管理に必要な下記の情報があること</p>
<ul>
<li><p>管理コンソールの URL</p></li>
<li><p>システム管理者のユーザID</p></li>
<li><p>システム管理者のパスワード</p></li>
</ul>
</li>
<li><p>作業クライアントに必要なアプリケーションがインストールされていること</p>
<ul>
<li><p><kbd class="kbd docutils literal notranslate">curl</kbd></p></li>
<li><p><kbd class="kbd docutils literal notranslate">git</kbd></p></li>
<li><p><kbd class="kbd docutils literal notranslate">jq</kbd></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="organization-creation">
<span id="id6"></span><h3><span class="section-number">1.3.3. </span>オーガナイゼーション作成<a class="headerlink" href="#organization-creation" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">オーガナイゼーションの作成方法には、下記の3通りの方法があります。</div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">設定ファイルとスクリプトによる作成</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">対話型スクリプトによる作成</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">Rest API による作成</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>特徴</p></li>
</ul>
<div class="line-block">
<div class="line">対話型スクリプトによる作成方法と違い複数のオーガナイゼーション管理ユーザを登録できます。</div>
</div>
<ul class="simple">
<li><p>作成方法</p></li>
</ul>
<div class="line-block">
<div class="line">GitHub リポジトリから取得した資材の中にある、シェルスクリプトを実行しオーガナイゼーションを作成します。</div>
</div>
<ol class="arabic">
<li><p>オーガナイゼーション作成用シェルスクリプトを、リポジトリから <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">git</kbd> <kbd class="kbd docutils literal notranslate">clone</kbd></kbd> により取得します。</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-number">リスト 1.52 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id10" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exastro Platform の資材を入手</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/exastro-suite/exastro-platform.git
</pre></div>
</div>
</div>
</li>
<li><p>設定ファイルの <kbd class="kbd docutils literal notranslate">CONF_BASE_URL</kbd> に Exastro Suite の管理用エンドポイント URL を設定します。</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-number">リスト 1.53 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id11" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exastro Platform への接続のための設定情報を登録</span>
vi<span class="w"> </span>./exastro-platform/tools/api-auth.conf
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">例えば、<a class="reference internal" href="../../installation/helm_on_kubernetes.html#service-setting"><span class="std std-ref">サービス公開の設定</span></a> で、Ingress を使ったサービス公開の設定をした場合は下記のようになります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-number">リスト 1.54 </span><span class="caption-text">create-organization.conf</span><a class="headerlink" href="#id12" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gd">- CONF_BASE_URL=http://platform-auth:8001</span>
<span class="linenos">2</span><span class="gi">+ CONF_BASE_URL=http://exastro-suite-mng.example.local</span>
<span class="linenos">3</span><span class="w"> </span> CURL_OPT=-sv
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">自己証明書を利用している場合、証明書エラーが発生します。</div>
<div class="line">設定ファイル内の <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">CURL_OPT=</kbd>-<kbd class="kbd docutils literal notranslate">sv</kbd></kbd> を <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">CURL_OPT=</kbd>-<kbd class="kbd docutils literal notranslate">svk</kbd></kbd> に変更することで証明書エラーを回避できますが、認証機関から発行された正しい証明書をインストールすることを推奨します。</div>
</div>
</div>
</li>
<li><p>オーガナイゼーション情報の設定</p>
<div class="line-block">
<div class="line">オーガナイゼーション作成時の初期登録情報として下記の項目を設定できます。</div>
</div>
<table class="docutils align-left" id="id13">
<caption><span class="caption-number">表 1.21 </span><span class="caption-text">オーガナイゼーション作成パラメータ</span><a class="headerlink" href="#id13" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>変更</p></th>
<th class="head"><p>デフォルト値・選択可能な設定値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーションIDを指定。</div>
<div class="line">英小文字、数字、ハイフン、アンダースコアが利用可能。</div>
<div class="line">最大36文字。</div>
<div class="line">※先頭文字は英小文字であること。</div>
<div class="line">※予約語(後述)に合致しないこと。</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーション名を指定。</div>
<div class="line">最大255文字</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001-name&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization_managers</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーション管理者の情報を指定。</div>
<div class="line">※複数名登録するときは繰り返し指定可能</div>
</div>
</td>
<td><p>可</p></td>
<td><p>(オーガナイゼーション管理者のリスト)</p></td>
</tr>
<tr class="row-odd"><td><p>organization_managers[*].username</p></td>
<td><p>オーガナイゼーション管理者のユーザ名（ログインするときのID）を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization_managers[*].email</p></td>
<td><p>オーガナイゼーション管理者のE-mailアドレスを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;<a class="reference external" href="mailto:admin&#37;&#52;&#48;example&#46;com">admin<span>&#64;</span>example<span>&#46;</span>com</a>&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization_managers[*].firstName</p></td>
<td><p>オーガナイゼーション管理者の名を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization_managers[*].lastName</p></td>
<td><p>オーガナイゼーション管理者の姓を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization_managers[*].credentials[0].type</p></td>
<td><p>認証方式を指定。</p></td>
<td><p>不可</p></td>
<td><p>&quot;password&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization_managers[*].credentials[0].value</p></td>
<td><p>オーガナイゼーション管理者の初期パスワードを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;password&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization_managers[*].credentials[0].temporary</p></td>
<td><p>初回ログイン時のパスワード変更の要否の有無を指定。</p></td>
<td><p>可</p></td>
<td><div class="line-block">
<div class="line"><strong class="program">true</strong> (デフォルト): パスワードの変更を要求する。</div>
<div class="line"><strong class="program">false</strong>: パスワードの変更を要求しない。</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>plan.id</p></td>
<td><p>リソースプランを指定。</p></td>
<td><p>可</p></td>
<td><p>※初期状態では存在しないため指定しない。</p></td>
</tr>
<tr class="row-odd"><td><p>options.sslRequired</p></td>
<td><p>SSL 接続の有無を指定。</p></td>
<td><p>可</p></td>
<td><div class="line-block">
<div class="line"><strong class="program">external</strong> (既定): プライベート IP アドレスに固定する限り、ユーザは SSL 無しで Keycloak と通信可能。</div>
<div class="line"><strong class="program">none</strong>: SSL の設定なし。</div>
<div class="line"><strong class="program">all</strong>: すべての IP アドレスに対し、SSL を要求。(内部の API が HTTP アクセスのため選択不可)</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">設定ファイルの作成は、<code class="file docutils literal notranslate"><span class="pre">./exastro-platform/tools/create-organization.sample.json</span></code> を基に、作成するオーガナイゼーションの情報を指定した JSON ファイルを基に作成します。</div>
</div>
<details>
  <summary>create-organization.sample.json</summary><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="w">    </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;org001&quot;</span><span class="p">,</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="w">  </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;org001-name&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="nt">&quot;organization_managers&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 5</span><span class="w">        </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">            </span><span class="nt">&quot;username&quot;</span><span class="w">  </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">            </span><span class="nt">&quot;email&quot;</span><span class="w">     </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="w">            </span><span class="nt">&quot;firstName&quot;</span><span class="w"> </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span><span class="w">            </span><span class="nt">&quot;lastName&quot;</span><span class="w">  </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="linenos">10</span><span class="w">            </span><span class="nt">&quot;credentials&quot;</span><span class="w">   </span><span class="p">:</span><span class="w">   </span><span class="p">[</span>
<span class="linenos">11</span><span class="w">                </span><span class="p">{</span>
<span class="linenos">12</span><span class="w">                    </span><span class="nt">&quot;type&quot;</span><span class="w">      </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
<span class="linenos">13</span><span class="w">                    </span><span class="nt">&quot;value&quot;</span><span class="w">     </span><span class="p">:</span><span class="w">   </span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
<span class="linenos">14</span><span class="w">                    </span><span class="nt">&quot;temporary&quot;</span><span class="w"> </span><span class="p">:</span><span class="w">   </span><span class="kc">true</span>
<span class="linenos">15</span><span class="w">                </span><span class="p">}</span>
<span class="linenos">16</span><span class="w">            </span><span class="p">],</span>
<span class="linenos">17</span><span class="w">            </span><span class="nt">&quot;requiredActions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos">18</span><span class="w">                </span><span class="s2">&quot;UPDATE_PROFILE&quot;</span>
<span class="linenos">19</span><span class="w">            </span><span class="p">],</span>
<span class="linenos">20</span><span class="w">            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="linenos">21</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">22</span><span class="w">    </span><span class="p">],</span>
<span class="linenos">23</span><span class="w">    </span><span class="nt">&quot;plan&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">24</span><span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;plan-1&quot;</span>
<span class="linenos">25</span><span class="w">    </span><span class="p">},</span>
<span class="linenos">26</span><span class="w">    </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="linenos">27</span><span class="p">}</span>
</pre></div>
</div>
</details><div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-number">リスト 1.55 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id14" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 設定用ファイルの作成</span>
cp<span class="w"> </span>-pi<span class="w"> </span>./exastro-platform/tools/create-organization<span class="o">{</span>.sample,<span class="o">}</span>.json

<span class="c1"># 設定用ファイルの編集</span>
vi<span class="w"> </span>./exastro-platform/tools/create-organization.json
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">optionsの値に <strong class="program">&quot;sslRequired&quot;: &quot;none&quot;</strong> を指定することで、オーガナイゼーションユーザが http でのアクセスが可能となります。</div>
</div>
</div>
</li>
<li><p>オーガナイゼーション作成実行</p>
<div class="line-block">
<div class="line">スクリプトを実行してオーガナイゼーションを作成します。</div>
<div class="line"><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">your</kbd> <kbd class="kbd docutils literal notranslate">username</kbd></kbd> と <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">your</kbd> <kbd class="kbd docutils literal notranslate">username</kbd></kbd> は <a class="reference internal" href="../../installation/helm_on_kubernetes.html#create-system-manager"><span class="std std-ref">Exastro システム管理者の作成</span></a> で登録した、<kbd class="kbd docutils literal notranslate">KEYCLOAK_USER</kbd> 及び <kbd class="kbd docutils literal notranslate">KEYCLOAK_PASSWORD</kbd> です。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-number">リスト 1.56 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id15" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>./exastro-platform/tools/create-organization.sh<span class="w"> </span>./exastro-platform/tools/create-organization.json

<span class="w"> </span>your<span class="w"> </span>username<span class="w"> </span>:<span class="w"> </span>INPUT-YOUR-USERNAME<span class="w"> </span><span class="c1"># システム管理者のユーザ名を入力します</span>
<span class="w"> </span>your<span class="w"> </span>password<span class="w"> </span>:<span class="w"> </span>INPUT-USER-PASSWORD<span class="w"> </span><span class="c1"># システム管理者のパスワードを入力します</span>

<span class="w"> </span>Create<span class="w"> </span>an<span class="w"> </span>organization,<span class="w"> </span>are<span class="w"> </span>you<span class="w"> </span>sure?<span class="w"> </span><span class="o">(</span>Y/other<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>Y<span class="w"> </span><span class="c1"># Y を入力するとオーガナイゼーションの作成処理が開始します</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">成功時の結果表示は、<kbd class="kbd docutils literal notranslate">result</kbd> が &quot;000-00000”となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-number">リスト 1.57 </span><span class="caption-text">実行結果 (成功時)</span><a class="headerlink" href="#id16" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
&lt;<span class="w"> </span>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">18</span><span class="w"> </span>Aug<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">01</span>:49:13<span class="w"> </span>GMT
&lt;<span class="w"> </span>Server:<span class="w"> </span>Apache/2.4.37<span class="w"> </span><span class="o">(</span>Red<span class="w"> </span>Hat<span class="w"> </span>Enterprise<span class="w"> </span>Linux<span class="o">)</span><span class="w"> </span>mod_wsgi/4.7.1<span class="w"> </span>Python/3.9
&lt;<span class="w"> </span>Content-Length:<span class="w"> </span><span class="m">107</span>
&lt;<span class="w"> </span>Content-Type:<span class="w"> </span>application/json
&lt;
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;data&quot;</span>:<span class="w"> </span>null,
<span class="w">  </span><span class="s2">&quot;message&quot;</span>:<span class="w"> </span><span class="s2">&quot;SUCCESS&quot;</span>,
<span class="w">  </span><span class="s2">&quot;result&quot;</span>:<span class="w"> </span><span class="s2">&quot;000-00000&quot;</span>,
<span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="s2">&quot;2022-08-18T01:49:17.251Z&quot;</span>
<span class="o">}</span>
*<span class="w"> </span>Connection<span class="w"> </span><span class="c1">#0 to host platform-auth left intact</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">失敗時の結果表示は、<kbd class="kbd docutils literal notranslate">result</kbd> が &quot;000-00000”以外となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-number">リスト 1.58 </span><span class="caption-text">実行結果 (失敗時)</span><a class="headerlink" href="#id17" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">400</span><span class="w"> </span>BAD<span class="w"> </span>REQUEST
&lt;<span class="w"> </span>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">18</span><span class="w"> </span>Aug<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">05</span>:29:35<span class="w"> </span>GMT
&lt;<span class="w"> </span>Server:<span class="w"> </span>Apache/2.4.37<span class="w"> </span><span class="o">(</span>Red<span class="w"> </span>Hat<span class="w"> </span>Enterprise<span class="w"> </span>Linux<span class="o">)</span><span class="w"> </span>mod_wsgi/4.7.1<span class="w"> </span>Python/3.9
&lt;<span class="w"> </span>Content-Length:<span class="w"> </span><span class="m">252</span>
&lt;<span class="w"> </span>Connection:<span class="w"> </span>close
&lt;<span class="w"> </span>Content-Type:<span class="w"> </span>application/json
&lt;
<span class="o">{</span><span class="w"> </span><span class="o">[</span><span class="m">252</span><span class="w"> </span>bytes<span class="w"> </span>data<span class="o">]</span>
*<span class="w"> </span>Closing<span class="w"> </span>connection<span class="w"> </span><span class="m">0</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;data&quot;</span>:<span class="w"> </span>null,
<span class="w">  </span><span class="s2">&quot;message&quot;</span>:<span class="w"> </span><span class="s2">&quot;指定されたorganization(org002)は作成済みのため、作成できません。&quot;</span>,
<span class="w">  </span><span class="s2">&quot;result&quot;</span>:<span class="w"> </span><span class="s2">&quot;400-23001&quot;</span>,
<span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="s2">&quot;2022-08-18T05:29:35.643Z&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</li>
</ol>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>特徴</p></li>
</ul>
<div class="line-block">
<div class="line">設定ファイルとスクリプトによる作成方法と違い設定ファイルの作成が不要です。</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">この方法の場合、オーガナイゼーション管理者は1人のみ指定できます。</div>
<div class="line">複数名オーガナイゼーション管理者を作成する場合は、<span class="menuselection">設定ファイルとスクリプトによる作成方法</span> を行ってください。</div>
</div>
</div>
<ul class="simple">
<li><p>作成方法</p></li>
</ul>
<div class="line-block">
<div class="line">画面の指示に従ってオーガナイゼーション情報を指定し、オーガナイゼーションを作成します。</div>
</div>
<div class="line-block">
<div class="line">GitHub リポジトリから取得した資材の中にある、シェルスクリプトを実行しオーガナイゼーションを作成します。</div>
</div>
<ol class="arabic">
<li><p>オーガナイゼーション作成用シェルスクリプトを、リポジトリから <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">git</kbd> <kbd class="kbd docutils literal notranslate">clone</kbd></kbd> により取得します。</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-number">リスト 1.59 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id18" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exastro Platform の資材を入手</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/exastro-suite/exastro-platform.git
</pre></div>
</div>
</div>
</li>
<li><p>設定ファイルの <kbd class="kbd docutils literal notranslate">CONF_BASE_URL</kbd> に Exastro Suite の管理用エンドポイント URL を設定します。</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-number">リスト 1.60 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id19" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exastro Platform への接続のための設定情報を登録</span>
vi<span class="w"> </span>./exastro-platform/tools/api-auth.conf
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">例えば、<a class="reference internal" href="../../installation/helm_on_kubernetes.html#service-setting"><span class="std std-ref">サービス公開の設定</span></a> で、Ingress を使ったサービス公開の設定をした場合は下記のようになります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-number">リスト 1.61 </span><span class="caption-text">create-organization.conf</span><a class="headerlink" href="#id20" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gd">- CONF_BASE_URL=http://platform-auth:8001</span>
<span class="linenos">2</span><span class="gi">+ CONF_BASE_URL=http://exastro-suite-mng.example.local</span>
<span class="linenos">3</span><span class="w"> </span> CURL_OPT=-sv
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">自己証明書を利用している場合、証明書エラーが発生します。</div>
<div class="line">設定ファイル内の <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">CURL_OPT=</kbd>-<kbd class="kbd docutils literal notranslate">sv</kbd></kbd> を <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">CURL_OPT=</kbd>-<kbd class="kbd docutils literal notranslate">svk</kbd></kbd> に変更することで証明書エラーを回避できますが、認証機関から発行された正しい証明書をインストールすることを推奨します。</div>
</div>
</div>
</li>
<li><p>オーガナイゼーション作成実行</p>
<div class="line-block">
<div class="line">オーガナイゼーション作成時の初期登録情報として下記の項目を設定できます。</div>
</div>
<table class="docutils align-left" id="id21">
<caption><span class="caption-number">表 1.22 </span><span class="caption-text">オーガナイゼーション作成パラメータ</span><a class="headerlink" href="#id21" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>変更</p></th>
<th class="head"><p>デフォルト値・選択可能な設定値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>organization id</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーションIDを指定。</div>
<div class="line">英小文字、数字、ハイフン、アンダースコアが利用可能。</div>
<div class="line">最大36文字。</div>
<div class="line">※先頭文字は英小文字であること。</div>
<div class="line">※予約語(後述)に合致しないこと。</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization name</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーション名を指定。</div>
<div class="line">最大255文字</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001-name&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's username</p></td>
<td><p>オーガナイゼーション管理者のユーザ名（ログインするときのID）を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization manager's email</p></td>
<td><p>オーガナイゼーション管理者のE-mailアドレスを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;<a class="reference external" href="mailto:admin&#37;&#52;&#48;example&#46;com">admin<span>&#64;</span>example<span>&#46;</span>com</a>&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's firstName</p></td>
<td><p>オーガナイゼーション管理者の名を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization manager's lastName</p></td>
<td><p>オーガナイゼーション管理者の姓を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's initial password</p></td>
<td><p>オーガナイゼーション管理者の初期パスワードを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;password&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>options.sslRequired</p></td>
<td><p>SSL 接続の有無を指定。</p></td>
<td><p>可</p></td>
<td><div class="line-block">
<div class="line"><strong class="program">external</strong> (既定): プライベート IP アドレスに固定する限り、ユーザは SSL 無しで Keycloak と通信可能。</div>
<div class="line"><strong class="program">none</strong>: SSL の設定なし。</div>
<div class="line"><strong class="program">all</strong>: すべての IP アドレスに対し、SSL を要求。(内部の API が HTTP アクセスのため選択不可)</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-number">リスト 1.62 </span><span class="caption-text">コマンド</span><a class="headerlink" href="#id22" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash<span class="w"> </span>./exastro-platform/tools/create-organization.sh
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line"><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">your</kbd> <kbd class="kbd docutils literal notranslate">username</kbd></kbd> と <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">your</kbd> <kbd class="kbd docutils literal notranslate">username</kbd></kbd> は <a class="reference internal" href="../../installation/helm_on_kubernetes.html#create-system-manager"><span class="std std-ref">Exastro システム管理者の作成</span></a> で登録した、<kbd class="kbd docutils literal notranslate">KEYCLOAK_USER</kbd> 及び <kbd class="kbd docutils literal notranslate">KEYCLOAK_PASSWORD</kbd> です。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-number">リスト 1.63 </span><span class="caption-text">コマンド (入力例)</span><a class="headerlink" href="#id23" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Please enter the organization information to be created

organization id : org001                             # オーガナイゼーションIDを入力します
organization name : org001-name                      # オーガナイゼーション名を入力します
organization manager&#39;s username : admin              # オーガナイゼーション管理者のユーザ名（ログインするときのID）を入力します
organization manager&#39;s email : admin@example.com     # オーガナイゼーション管理者のE-mailアドレスを入力します
organization manager&#39;s first name : admin            # オーガナイゼーション管理者の名を入力します
organization manager&#39;s last name : admin             # オーガナイゼーション管理者の姓を入力します
organization manager&#39;s initial password : password   # オーガナイゼーション管理者の初期パスワードを入力します
organization plan id (optional) :                    # リソースプランを指定(任意)します ※ 初期状態では未作成のため入力不要

your username : INPUT-YOUR-USERNAME                  # システム管理者のユーザ名を入力します
your password : INPUT-USER-PASSWORD                  # システム管理者のパスワードを入力します

Create an organization, are you sure? (Y/other) : Y # &quot;Y&quot;を入力すると実行します
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">成功時の結果表示は、<kbd class="kbd docutils literal notranslate">result</kbd> が &quot;000-00000”となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-number">リスト 1.64 </span><span class="caption-text">実行結果 (成功時)</span><a class="headerlink" href="#id24" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
&lt;<span class="w"> </span>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">18</span><span class="w"> </span>Aug<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">01</span>:49:13<span class="w"> </span>GMT
&lt;<span class="w"> </span>Server:<span class="w"> </span>Apache/2.4.37<span class="w"> </span><span class="o">(</span>Red<span class="w"> </span>Hat<span class="w"> </span>Enterprise<span class="w"> </span>Linux<span class="o">)</span><span class="w"> </span>mod_wsgi/4.7.1<span class="w"> </span>Python/3.9
&lt;<span class="w"> </span>Content-Length:<span class="w"> </span><span class="m">107</span>
&lt;<span class="w"> </span>Content-Type:<span class="w"> </span>application/json
&lt;
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;data&quot;</span>:<span class="w"> </span>null,
<span class="w">  </span><span class="s2">&quot;message&quot;</span>:<span class="w"> </span><span class="s2">&quot;SUCCESS&quot;</span>,
<span class="w">  </span><span class="s2">&quot;result&quot;</span>:<span class="w"> </span><span class="s2">&quot;000-00000&quot;</span>,
<span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="s2">&quot;2022-08-18T01:49:17.251Z&quot;</span>
<span class="o">}</span>
*<span class="w"> </span>Connection<span class="w"> </span><span class="c1">#0 to host platform-auth left intact</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">失敗時の結果表示は、<kbd class="kbd docutils literal notranslate">result</kbd> が &quot;000-00000”以外となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-number">リスト 1.65 </span><span class="caption-text">実行結果 (失敗時)</span><a class="headerlink" href="#id25" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">400</span><span class="w"> </span>BAD<span class="w"> </span>REQUEST
&lt;<span class="w"> </span>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">18</span><span class="w"> </span>Aug<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">05</span>:29:35<span class="w"> </span>GMT
&lt;<span class="w"> </span>Server:<span class="w"> </span>Apache/2.4.37<span class="w"> </span><span class="o">(</span>Red<span class="w"> </span>Hat<span class="w"> </span>Enterprise<span class="w"> </span>Linux<span class="o">)</span><span class="w"> </span>mod_wsgi/4.7.1<span class="w"> </span>Python/3.9
&lt;<span class="w"> </span>Content-Length:<span class="w"> </span><span class="m">252</span>
&lt;<span class="w"> </span>Connection:<span class="w"> </span>close
&lt;<span class="w"> </span>Content-Type:<span class="w"> </span>application/json
&lt;
<span class="o">{</span><span class="w"> </span><span class="o">[</span><span class="m">252</span><span class="w"> </span>bytes<span class="w"> </span>data<span class="o">]</span>
*<span class="w"> </span>Closing<span class="w"> </span>connection<span class="w"> </span><span class="m">0</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;data&quot;</span>:<span class="w"> </span>null,
<span class="w">  </span><span class="s2">&quot;message&quot;</span>:<span class="w"> </span><span class="s2">&quot;指定されたorganization(org002)は作成済みのため、作成できません。&quot;</span>,
<span class="w">  </span><span class="s2">&quot;result&quot;</span>:<span class="w"> </span><span class="s2">&quot;400-23001&quot;</span>,
<span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="s2">&quot;2022-08-18T05:29:35.643Z&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</li>
</ol>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>特徴</p></li>
</ul>
<div class="line-block">
<div class="line">外部システムからオーガナイゼーションの作成を行う場合は、Rest API を使います。</div>
</div>
<ul class="simple">
<li><p>作成方法</p></li>
</ul>
<ol class="arabic">
<li><p>オーガナイゼーション作成実行</p>
<div class="line-block">
<div class="line">Rest API を使ってオーガナイゼーションを作成します。</div>
<div class="line">利用可能なパラメータは下記のとおりです。</div>
<div class="line">詳細は、<a class="reference internal" href="../../reference/api/system_manager/platform-api.html"><span class="doc">Exastro Platform API</span></a> を参照してください。</div>
</div>
<table class="docutils align-left" id="id26">
<caption><span class="caption-number">表 1.23 </span><span class="caption-text">オーガナイゼーション作成パラメータ</span><a class="headerlink" href="#id26" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>変更</p></th>
<th class="head"><p>デフォルト値・選択可能な設定値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>organization id</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーションIDを指定。</div>
<div class="line">英小文字、数字、ハイフン、アンダースコアが利用可能。</div>
<div class="line">最大36文字。</div>
<div class="line">※先頭文字は英小文字であること。</div>
<div class="line">※予約語(後述)に合致しないこと。</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization name</p></td>
<td><div class="line-block">
<div class="line">オーガナイゼーション名を指定。</div>
<div class="line">最大255文字</div>
</div>
</td>
<td><p>可</p></td>
<td><p>&quot;org001-name&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's username</p></td>
<td><p>オーガナイゼーション管理者のユーザ名（ログインするときのID）を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization manager's email</p></td>
<td><p>オーガナイゼーション管理者のE-mailアドレスを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;<a class="reference external" href="mailto:admin&#37;&#52;&#48;example&#46;com">admin<span>&#64;</span>example<span>&#46;</span>com</a>&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's firstName</p></td>
<td><p>オーガナイゼーション管理者の名を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>organization manager's lastName</p></td>
<td><p>オーガナイゼーション管理者の姓を指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;admin&quot;</p></td>
</tr>
<tr class="row-even"><td><p>organization manager's initial password</p></td>
<td><p>オーガナイゼーション管理者の初期パスワードを指定。</p></td>
<td><p>可</p></td>
<td><p>&quot;password&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>options.sslRequired</p></td>
<td><p>SSL 接続の有無を指定。</p></td>
<td><p>可</p></td>
<td><div class="line-block">
<div class="line"><strong class="program">external</strong> (既定): プライベート IP アドレスに固定する限り、ユーザは SSL 無しで Keycloak と通信可能。</div>
<div class="line"><strong class="program">none</strong>: SSL の設定なし。</div>
<div class="line"><strong class="program">all</strong>: すべての IP アドレスに対し、SSL を要求。(内部の API が HTTP アクセスのため選択不可)</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ol>
<div class="line-block">
<div class="line">cURL を使って Rest API を利用する場合は、以下の様なコマンドを実行してください。</div>
<div class="line">BASIC 認証で使用する認証情報は <a class="reference internal" href="../../installation/helm_on_kubernetes.html#create-system-manager"><span class="std std-ref">Exastro システム管理者の作成</span></a> で登録した、<kbd class="kbd docutils literal notranslate">KEYCLOAK_USER</kbd> 及び <kbd class="kbd docutils literal notranslate">KEYCLOAK_PASSWORD</kbd> です。</div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<div class="line-block">
<div class="line">BASIC 認証を行うために、Exastro Platform 管理者の認証情報を <kbd class="kbd docutils literal notranslate">BASE64_BASIC</kbd> に設定する必要があります。</div>
</div>
</div>
<div class="line-block">
<div class="line">また、Exastro Platform の管理用 URL 情報を <kbd class="kbd docutils literal notranslate">BASE_URL</kbd> に設定する必要があります。</div>
<div class="line">例えば、 <a class="reference internal" href="../../installation/helm_on_kubernetes.html#ingress-setting"><span class="std std-ref">サービス公開の設定 (Ingress の設定)</span></a> をした場合は下記のようになります。</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">BASE64_BASIC</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;KEYCLOAK_USER:KEYCLOAK_PASSWORD&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="k">)</span>
<span class="nv">BASE_URL</span><span class="o">=</span>http://exastro-suite-mng.example.local

curl<span class="w"> </span>-X<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASE_URL</span><span class="si">}</span><span class="s2">/api/platform/organizations&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Basic </span><span class="si">${</span><span class="nv">BASE64_BASIC</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;id&quot;: &quot;org001&quot;,</span>
<span class="s1">  &quot;name&quot;: &quot;org001-name&quot;,</span>
<span class="s1">  &quot;organization_managers&quot;: [</span>
<span class="s1">    {</span>
<span class="s1">      &quot;username&quot;: &quot;admin&quot;,</span>
<span class="s1">      &quot;email&quot;: &quot;admin@example.com&quot;,</span>
<span class="s1">      &quot;firstName&quot;: &quot;admin&quot;,</span>
<span class="s1">      &quot;lastName&quot;: &quot;admin&quot;,</span>
<span class="s1">      &quot;credentials&quot;: [</span>
<span class="s1">        {</span>
<span class="s1">          &quot;type&quot;: &quot;password&quot;,</span>
<span class="s1">          &quot;value&quot;: &quot;password&quot;,</span>
<span class="s1">          &quot;temporary&quot;: true</span>
<span class="s1">        }</span>
<span class="s1">      ],</span>
<span class="s1">      &quot;requiredActions&quot;: [</span>
<span class="s1">        &quot;UPDATE_PROFILE&quot;</span>
<span class="s1">      ],</span>
<span class="s1">      &quot;enabled&quot;: true</span>
<span class="s1">    }</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;plan&quot;: {},</span>
<span class="s1">  &quot;options&quot;: {}</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="id7">
<h2><span class="section-number">1.4. </span>オーガナイゼーションへのアクセス<a class="headerlink" href="#id7" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">オーガナイゼーション用サイトが表示できるかWebブラウザから確認します。</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 書式</span>
<span class="n">http</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span><span class="o">//</span><span class="p">{</span><span class="n">Exastro</span> <span class="n">Platform</span> <span class="n">の管理用</span> <span class="n">URL</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">オーガナイゼーションID</span><span class="p">}</span><span class="o">/</span><span class="n">platform</span><span class="o">/</span>

<span class="c1"># 具体例</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">exastro</span><span class="o">-</span><span class="n">suite</span><span class="o">-</span><span class="n">mng</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">local</span><span class="o">/</span><span class="n">org001</span><span class="o">/</span><span class="n">platform</span><span class="o">/</span>
</pre></div>
</div>
</section>
<section id="id8">
<h2><span class="section-number">1.5. </span>その他制約事項・備考<a class="headerlink" href="#id8" title="この見出しへのパーマリンク">¶</a></h2>
<section id="id">
<h3><span class="section-number">1.5.1. </span>オーガナイゼーションIDの予約語<a class="headerlink" href="#id" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">以下に示すパターンに合致するワードは、オーガナイゼーションの ID として使用できません。</div>
</div>
<ul class="simple">
<li><p>master</p></li>
<li><p>platform</p></li>
<li><p>account</p></li>
<li><p>account-console</p></li>
<li><p>admin-cli</p></li>
<li><p>broker</p></li>
<li><p>realm-management</p></li>
<li><p>security-admin-console</p></li>
<li><p>*-workspaces</p></li>
<li><p>system-*-auth</p></li>
</ul>
</section>
<section id="id9">
<h3><span class="section-number">1.5.2. </span>オーガナイゼーション作成を再実行する場合<a class="headerlink" href="#id9" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">オーガナイゼーション作成で失敗した場合、オーガナイゼーション作成の再実行をしても「指定されたorganization(xxx)は作成済みのため、作成できません。」というエラーが表示されることがあります。</div>
<div class="line">このように、失敗したオーガナイゼーション ID でオーガナイゼーションの作成ができない場合は、コマンドパラメータに <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">-</kbd>-<kbd class="kbd docutils literal notranslate">retry</kbd></kbd> オプションを付与して実行することで再作成をすることが可能です。</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./exastro-platform/tools/create-organization.sh<span class="w"> </span>--retry
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./exastro-platform/tools/create-organization.sh<span class="w"> </span>./exastro-platform/tools/create-organization.sample.json
</pre></div>
</div>
</section>
</section>
</section>


</div>


<div id="articleNavigation">
  <ul>
    <li class="prev"><a href="index.html" title="前のトピックへ"><span>前のトピックへ</span>システム管理</a></li>
    <li class="next"><a href="plan.html" title="次のトピックへ"><span>次のトピックへ</span><span class="section-number">2. </span>リソースプラン</a></li>
  </ul>
</div>


<div id="pageTopLink">
  <a href="#container"><i>↑</i> Page Top</a>
</div>

</article>
</div>
</main>
</div><!-- End #contents -->
<div id="footer">
  <footer class="divInner">
    <small>Copyright © 2019-2023 NEC Corporation</small>
    <small><a href="/terms/ja.html">サイト規約</a></small>
  </footer>
</div><!-- End #footer -->

<div id="overlay"></div>
<div id="grayBack"></div>

</div><!-- End #container -->
  </body>
</html>