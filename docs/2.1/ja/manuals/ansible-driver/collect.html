
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>収集機能 &#8212; Documentation  ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/option.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/exastro_documents.css?v=3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/swagger/swagger-ui.css" />
    
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/translations.js"></script>
    <script src="../../../../_static/jquery-3.6.3.min.js"></script>
    <script src="../../../../_static/exastro_documents.js?v=1"></script>
    <script src="../../../../_static/swagger/swagger-ui-bundle.js"></script>
    <script src="../../../../_static/swagger/swagger-ui-standalone-preset.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" /> 
  </head>
<body id="page" class="ja">


<div id="container">

<div id="header">
  <header class="divInner">
    <!-- Exastro logo -->
    <div id="logo"><a href="https://ita.exastro.org/"><img src="../../../../_static/img/exastro.svg" alt="Exastro"></a></div>
    <!-- Project name -->
    <div id="projectName"><a href="../../../../index.html">Documentation</a></div>
    <!-- Heaedr navigation -->
    <div id="headerSearch">
      <form class="search" action="../../../../search.html" method="get">
        <input type="text" name="q" aria-labelledby="searchlabel">
        <button type="submit" value="検索"><img src="../../../../_static/img/search.png" alt="検索"></button>
      </form>
    </div>
  </header>
</div><!-- End #header -->


<div id="toolbar">
  <div class="divInner">
    
    <div id="documentVersion">
      <dl>
        <dt>Document version</dt>
        <dd>
          <div>
            <select name="version" onchange="location.href=value;">
                file_path: 2.0/ja/manuals/ansible-driver/collect
                file_path: 2.0/ja/manuals/ansible-driver/collect
                file_path: 2.1/ja/manuals/ansible-driver/collect
                  <option value="#"
                  selected
                  >2.1 (beta)</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>

    <div id="documentLanguage">
      <dl>
        <dt>Language</dt>
        <dd>
          <div>
            <select name="lang" onchange="location.href=value;">
                file_path: 2.1/ja/manuals/ansible-driver/collect
                hasdoc: True
                  <option value="#"
                  selected
                  >日本語</option>
                file_path: 2.1/en/manuals/ansible-driver/collect
                hasdoc: False
            </select>
          </div>
        </dd>
      </dl>
    </div>
    <div id="toolbarNavigation">
      <ul>
      </ul>
    </div>
  </div>
</div><!-- End #toolbar -->

<div id="sideMenu">

  <div id="menuButton"></div>
  
  <aside class="divInner">
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../2.0/index.html">Exastro IT Automation Documentation 2.0</a></li>
</ul>

    <!-- <ul>
      <li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">索引</a></li>
    </ul> -->
    
  </aside>
</div><!-- End #sideMenu -->


<div id="tableOfContents">
  <div id="tocButton"></div>
  <ul>
<li><a class="reference internal" href="#">収集機能</a><ul>
<li><a class="reference internal" href="#id2">はじめに</a></li>
<li><a class="reference internal" href="#id3">収集機能概要</a><ul>
<li><a class="reference internal" href="#id4">収集機能について</a><ul>
<li><a class="reference internal" href="#id5">収集機能概要図</a></li>
<li><a class="reference internal" href="#id6">収集機能データ登録処理概要図</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">パラメータシートへの登録方法について</a><ul>
<li><a class="reference internal" href="#id8">収集機能の動作要件</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id9">収集機能でのディレクトリ、ファイル構造、変数取り扱い</a><ul>
<li><a class="reference internal" href="#id10">収集対象ディレクトリ、ファイル構造</a></li>
<li><a class="reference internal" href="#id11">取り扱う変数と種類</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">収集機能 コンソールメニュー構成</a><ul>
<li><a class="reference internal" href="#id13">メニュー/画面一覧</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">収集機能の利用手順</a><ul>
<li><a class="reference internal" href="#id15">作業フロー</a><ul>
<li><a class="reference internal" href="#id16">収集機能作業フロー</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id17">収集機能・操作方法説明</a><ul>
<li><a class="reference internal" href="#ansible">Ansible 共通コンソール</a><ul>
<li><a class="reference internal" href="#id18">収集インターフェース情報</a></li>
<li><a class="reference internal" href="#id19">収集項目値管理</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ansible-legacyansible-pioneeransible-legacyrole">Ansible-Legacy、Ansible-Pioneer、Ansible-LegacyRoleコンソール</a><ul>
<li><a class="reference internal" href="#id20">収集状況の確認</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backyard">BackYardコンテンツ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id23">運用操作</a><ul>
<li><a class="reference internal" href="#id24">メンテナンス</a></li>
<li><a class="reference internal" href="#id25">メンテナンス方法について</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id26">付録</a><ul>
<li><a class="reference internal" href="#id27">参考資材</a></li>
<li><a class="reference internal" href="#id28">収集実行例</a><ul>
<li><a class="reference internal" href="#id29">複数ファイルの同一メニューを対象とした場合</a></li>
<li><a class="reference internal" href="#id31">収集対象ファイルの値の取り扱い</a></li>
<li><a class="reference internal" href="#id33">複数の同一ファイル名がアップロード対象ファイルの指定例</a></li>
<li><a class="reference internal" href="#id34">ファイル削除時の収集対象ファイル内の記載例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>


<div id="contents">
<main class="divInner">

 <div id="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">HOME</a></li>
    
    <li>収集機能</li>
  </ul>
</div>

<div id="article">
<article class="divInner">
<div class="body" role="main">

  <section id="id1">
<h1>収集機能<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h1>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本書では、ITAの機能および操作方法について説明します。</div>
</div>
</section>
<section id="id3">
<h2>収集機能概要<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本章では収集機能について説明します。</div>
</div>
<section id="id4">
<h3>収集機能について<a class="headerlink" href="#id4" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">収集機能とは、ITAで実施した、作業実行結果（規定のフォーマットで出力されたソースファイル）を元に、パラメータシートへ値を自動で登録する機能です。</div>
<div class="line">本機能は、Ansible-Driverを対象としています。</div>
<div class="line">Ansibleの詳細情報については、「Ansibleの製品マニュアル」を参照してください。</div>
<div class="line">Ansible-Driverの詳細情報については、「利用手順マニュアルAnsible-driver」を参照してください。</div>
<div class="line">パラメータシートの詳細については、「利用手順マニュアルメニュー作成機能」を参照してください。</div>
</div>
<section id="id5">
<h4>収集機能概要図<a class="headerlink" href="#id5" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">以下は、収集機能実行までの全体の概要図です。</div>
</div>
<a class="reference internal image-reference" href="../../../../_images/overview3.png"><img alt="収集機能概要図" src="../../../../_images/overview3.png" style="width: 6.00372in; height: 2.87662in;" /></a>
</section>
<section id="id6">
<h4>収集機能データ登録処理概要図<a class="headerlink" href="#id6" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">以下は、収集機能のデータ登録処理の概要図です。</div>
</div>
<a class="reference internal image-reference" href="../../../../_images/overview21.png"><img alt="収集機能データ登録処理概要図" src="../../../../_images/overview21.png" style="width: 6.00372in; height: 2.87662in;" /></a>
<div class="line-block">
<div class="line">※収集機能のデータ型の取り扱い例については、「<strong>7.2.2収集対象ファイルの値の取り扱い</strong>」をご参照ください。</div>
</div>
</section>
</section>
<section id="id7">
<h3>パラメータシートへの登録方法について<a class="headerlink" href="#id7" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">収集機能は、ITAのオプションとして機能し、ITAの標準RESTAPI機能を利用してパラメータシートへの登録処理を実施します。</div>
<div class="line">RESTAPI機能の詳細については、「利用手順マニュアル_RestAPI」を参照してください。</div>
</div>
<section id="id8">
<h4>収集機能の動作要件<a class="headerlink" href="#id8" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">ITAで以下の設定がされている必要があります。</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">ITA インストーラにて、「createparam」、「ansible_driver」が選択され、インストールされている</div>
</div>
</li>
<li><div class="line-block">
<div class="line">メニュー定義/作成にて、パラメータシート（ホスト/オペレーションあり）が作成されている</div>
</div>
</li>
<li><div class="line-block">
<div class="line">設定値項目管理にて、登録情報（ソースファイル）とパラメータシートの項目と紐づけ設定がされている</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集インターフェース情報のRESTアクセス情報を更新済み</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集対象機器（ホスト名）が、機器一覧に登録済み</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">作業実行後に、以下の状態である場合、パラメータシートへの登録を実施します。</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">作業実行の結果、正常に完了している</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作業実行の出力結果として、規定の構造でディレクトリ、ファイルが配置されている</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">※パラメータシートへの登録元となるソースファイルを生成するIaC（Playbook、Role）については、各ユーザー様で準備する必要があります。</div>
</div>
<div class="line-block">
<div class="line">参考： Ansible Playbook Collection（OS設定収集）</div>
<div class="line"><a class="reference external" href="https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md">https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md</a></div>
</div>
</section>
</section>
</section>
<section id="id9">
<h2>収集機能でのディレクトリ、ファイル構造、変数取り扱い<a class="headerlink" href="#id9" title="この見出しへのパーマリンク">¶</a></h2>
<section id="id10">
<h3>収集対象ディレクトリ、ファイル構造<a class="headerlink" href="#id10" title="この見出しへのパーマリンク">¶</a></h3>
<ol class="arabic">
<li><p>収集対象のファイルフォーマット</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Yaml形式で出力されたファイル</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">:name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RH_snmp.yaml</span>

<span class="l l-Scalar l-Scalar-Plain">e.g.)</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイル名：RH_snmp.yml</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイルの内容：</span>
<span class="nt">VAR_RH_sshd_config</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PermitRootLogin</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PasswordAuthentication</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>収集対象ディレクトリ構造</p></li>
</ol>
<div class="line-block">
<div class="line">収集対象ディレクトリについて、収集対象ディレクトリパス（ソースファイルの出力先として）をIaC(Playbook,Role)内にて、で以下の変数として扱えます。</div>
</div>
<table class="docutils align-left" id="id35">
<caption><span class="caption-text">表 2-1 収集機能対象ディレクトリITA 独自変数</span><a class="headerlink" href="#id35" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 54%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ITA独自変数</p></th>
<th class="head"><p>変数指定内容</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__parameter_dir__</p></td>
<td><p>作業結果ディレクトリ配下の「_parameters」のパス</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>__parameters_file_dir__</p></td>
<td><p>作業結果ディレクトリ配下の「_parameters_file」のパス</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>__parameters_dir_for_epc__</p></td>
<td><p>作業ディレクトリ配下の「_parameters」のパス</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>__parameters_file_dir_for_epc__</p></td>
<td><p>作業ディレクトリ配下の「_parameters_file」のパス</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">収集対象のディレクトリ（_parameters）の上位ディレクトリのパスについて、「Ansible共通」-「インターフェース情報」の「データリレイストレージパス(Ansible)」、Ansible-Driverの実行モード、実施した作業Noに依存します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id36">
<div class="code-block-caption"><span class="caption-text">上位ディレクトリ</span><a class="headerlink" href="#id36" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">|</span>-<span class="w">  </span>_parameters<span class="w">           </span>※1
<span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost<span class="w">         </span>※2
<span class="p">|</span><span class="w">       </span><span class="p">|</span>-<span class="w">  </span>SAMPLE.yml<span class="w">    </span>※3
<span class="p">|</span>-<span class="w">  </span>_parameters_file<span class="w">      </span>※4
<span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost<span class="w">         </span>※2
<span class="w">        </span><span class="p">|</span>-<span class="w">  </span>test.txt<span class="w">      </span>※5
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">※データリレイストレージパス(Ansible)以降の階層構造</div>
</div>
<ul class="simple">
<li><p>備考</p></li>
</ul>
<div class="line-block">
<div class="line">※1 収集対象ディレクトリ（名称固定）</div>
<div class="line">※2ホスト名（機器一覧に登録されているものが収集対象）</div>
<div class="line">※3 収集対象ファイル</div>
<div class="line">※4収集対象ディレクトリファイルアップロード用（名称固定）</div>
<div class="line">※5ファイルアップロード対象ファイル</div>
</div>
<div class="line-block">
<div class="line">ソースファイルを生成するPlaybookを作成する際、の出力先について、「表 2-1 収集機能対象ディレクトリITA独自変数」を使用しない場合、以下の構造を認識してPlaybookを記述する必要があります。</div>
</div>
<table class="docutils align-left" id="id37">
<caption><span class="caption-text">表 2-3 Ansible-Driverモード別上位ディレクトリパス</span><a class="headerlink" href="#id37" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 54%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>モード</p></th>
<th class="head"><p>モード別識別子</p></th>
<th class="head"><p>階層構造</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ansible-Legacy</p></td>
<td><p>legacy/ns/</p></td>
<td><p>/データリレイストレージパス(Ansible）/legacy/ns/</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Ansible-Pioneer</p></td>
<td><p>pioneer/ns/</p></td>
<td><p>/データリレイストレージパス(Ansible）/pioneer /ns/</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Ansible-LegacyRole</p></td>
<td><p>legacy/rl/</p></td>
<td><p>/データリレイストレージパス(Ansible）/legacy/rl/</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>e.g.)　収集対象ファイルのファイルパス、ディレクトリ構造</p>
<p>実行モード： Ansible-Legacy</p>
<p>作業No ： 1</p>
<p>対象ホスト： localhost</p>
<p>作業実行ディレク
トリ；/データリレイストレージパス(Ansible）/legacy/ns/0000000001/in/</p>
<p>作業結果ディレクト
リ；/データリレイストレージパス(Ansible）/legacy/ns/0000000001/out/</p>
<p>収集対象ファイルパス、ディレクトリ構造：</p>
<p>/データリレイストレージパス
(Ansible）/legacy/ns/0000000001/in/_parameters/localhost/SAMPLE.yml</p>
<p>/データリレイストレージパス(Ans
ible）/legacy/ns/0000000001/in/_parameters/localhost/OS/RH_snmpd.yml</p>
<p>/データリレイストレージパス(A
nsible）/legacy/ns/0000000001/in/_parameters_file/localhost/TEST.txt</p>
<p>もしくは、</p>
<p>/データリレイストレージパス
(Ansible）/legacy/ns/0000000001/out/_parameters/localhost/SAMPLE.yml</p>
<p>/データリレイストレージパス(Ansi
ble）/legacy/ns/0000000001/out/_parameters/localhost/OS/RH_snmpd.yml</p>
<p>/データリレイストレージパス(An
sible）/legacy/ns/0000000001/out/_parameters_file/localhost/TEST.txt</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">ファイルアップロードのメニューを収集対象とする場合、ソースファイルの変数の値（ファイル名/ファイルパス）と該当するファイル、が_parameters_file配下に配置されている必要があります。</div>
<div class="line">収集項目値管理の設定は、「5.1.2 収集項目値管理」参照してください。</div>
<div class="line">ファイルアップロードの最大ファイルサイズについて、サーバースペックに依存するため、詳細は、「利用手順マニュアル_RestAPI」を参照してください。</div>
<div class="line">_parameters_file配下に配置されているアップロード対象ファイルの指定方法として、以下の記載方法があります。</div>
</div>
<table class="docutils align-left" id="id38">
<caption><span class="caption-text">表  2-4 アップロード対象ファイルの指定方法</span><a class="headerlink" href="#id38" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 65%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>指定方式</p></th>
<th class="head"><p>YAMLファイルへの記載方法</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ファイル名指定</p></td>
<td><p>VAR_FILE_NAME : &lt;‘ファイル名&gt; ’</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ファイルパス指定 (完全一致)</p></td>
<td><p>VAR_FILE_NAME : ‘/&lt;上位ディレクトリ&gt;/_parameters_file/ localhost/&lt;階層X&gt;/&lt;ファイル名&gt;’</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ファイルパス指定 (後方一致)</p></td>
<td><p>VAR_FILE_NAME : ‘/&lt;階層X&gt;/&lt;ファイル名&gt;’</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">※ファイル名指定時、該当するファイルが複数存在する場合、対象となるファイルは、ランダムとなります。</div>
<div class="line">ファイルパス指定(完全一致)時、該当するパスにあるファイルとなります。</div>
<div class="line">ファイルパス指定(後方一致)時、該当するファイルが複数ある場合、対象となるファイルは、ランダムとなります。</div>
</div>
<div class="line-block">
<div class="line">■　e.g.) 通常変数の構造の変数の場合のディレクトリ構造とソースファイルの内容</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>■構造
【上位ディレクトリ】
<span class="w">    </span><span class="p">|</span>-<span class="w">  </span>_parameters
<span class="w">    </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost
<span class="w">    </span><span class="p">|</span><span class="w">       </span><span class="p">|</span>-<span class="w">  </span>SAMPLE.yml<span class="w">             </span>※ソースファイル
<span class="w">    </span><span class="p">|</span>-<span class="w">  </span>_parameters_file
<span class="w">    </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost
<span class="w">    </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>-<span class="w">  </span>test.txt<span class="w">                </span>※アップロード対象ファイル
<span class="w">    </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>-<span class="w">  </span>APP001
<span class="w">              </span><span class="p">|</span>-<span class="w">  </span>config<span class="w">               </span>※アップロード対象ファイル

<span class="w"> </span>■収集対象ファイル名：SAMPLE.yml
<span class="w"> </span>■ファイルの内容
<span class="w"> </span>VAR_upload_file:<span class="w"> </span>test.txt

<span class="w"> </span>VAR_upload_fileX:<span class="w"> </span>config
<span class="w"> </span>VAR_upload_fileY:<span class="w"> </span>‘/&lt;上位ディレクトリ&gt;/_parameters_file<span class="w"> </span>/localhost<span class="w"> </span>/APP001/config’
<span class="w"> </span>VAR_upload_fileZ:<span class="w"> </span>‘/APP001/config
</pre></div>
</div>
</section>
<section id="id11">
<h3>取り扱う変数と種類<a class="headerlink" href="#id11" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">収集機能で扱うソースファイル内で扱える変数は以下の3種類があります。</div>
</div>
<table class="docutils align-default" id="id39">
<caption><span class="caption-text">表 2.1 変数の種類</span><a class="headerlink" href="#id39" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>種類</p></th>
<th class="head"><p>内容</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>通常変数</p></td>
<td><p>変数名に対して具体値を1つ定義できる変数です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">VAR_users</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
</pre></div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p>複数具体値変数</p></td>
<td><p>変数名に対して具体値を複数定義できる変数です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">VAR_users</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
</pre></div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p>多段変数</p></td>
<td><p>階層化された変数です。</p>
<p>e.g.)</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">VAR_users</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alice</span><span class="w">      </span><span class="c1">#メンバ変数</span>
<span class="w">    </span><span class="nt">authorized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">変数名は、下記の7文字を除くascii文字(0x20～0x7e)が使用出来ます。</div>
<div class="line-block">
<div class="line">&quot; . [ ] ' \ :</div>
</div>
</div>
<div class="line-block">
<div class="line">尚、コーテーションで囲まないと変数名の先頭に使用出来ない文字がいくつかあります。</div>
<div class="line">詳しくは、Ansibleドキュメント   <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html#gotchas">Yamlsyntax</a>を参照下さい。</div>
</div>
</td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="id12">
<h2>収集機能 コンソールメニュー構成<a class="headerlink" href="#id12" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本章では、ITAコンソールのメニュー構成について説明します。</div>
</div>
<section id="id13">
<h3>メニュー/画面一覧<a class="headerlink" href="#id13" title="この見出しへのパーマリンク">¶</a></h3>
<ol class="arabic simple">
<li><p>Ansible共通コンソールのメニュー</p></li>
</ol>
<div class="line-block">
<div class="line">Ansible共通コンソールのメニュー一覧を以下に記述します。</div>
</div>
<table class="docutils align-default" id="id40">
<caption><span class="caption-text">表 3-1共通コンソール メニュー/画面一覧</span><a class="headerlink" href="#id40" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>No</p></th>
<th class="head"><p>メニューグループ</p></th>
<th class="head"><p>メニュー・画面</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td rowspan="2"><p>Ansible共通</p>
<p>コンソール</p>
</td>
<td><p>収集インターフェース情報</p></td>
<td><p>パラメータシートへのデータの登録時に使用する、ITA標準REST機能にアクセスするサーバへの接続インターフェース情報を管理します。</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>設定項目値管理</p></td>
<td><p>作業実行の出力結果（ソースファイル）と、パラメータシートの項目の紐づけ設定を行い、収集機能で登録する対象パラメータを管理します。</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>Ansibleコンソールのメニュー</p></li>
</ol>
<div class="line-block">
<div class="line">各Ansibleコンソールに対応するメニュー一覧を以下に記述します。</div>
</div>
<table class="docutils align-default" id="id41">
<caption><span class="caption-text">表 3-2 Ansible driverコンソール メニュー/画面一覧</span><a class="headerlink" href="#id41" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>No</p></th>
<th class="head" colspan="3"><p>メニュー
グループ</p></th>
<th class="head" rowspan="3"><p>メニュー・画面</p></th>
<th class="head" rowspan="3"><p>説明</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="3"><p>Ansibleコンソール</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>Legacy</p></th>
<th class="head"><p>LegacyRole</p></th>
<th class="head"><p>Pioneer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>14</p></td>
<td><p><strong>○</strong></p></td>
<td><p><strong>○</strong></p></td>
<td><p><strong>○</strong></p></td>
<td><p>作業管理</p></td>
<td><p>作業実行履歴を管理します。</p>
<p>収集機能によるパラメータシートの登録状況、実行ログを参照します。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image7.png"><img alt="作業管理画面" src="2.1/ja/manuals/ansible-driver/collect/image7.png" style="width: 6.00372in; height: 2.87662in;" /></a>
<p><strong>図</strong> <strong>3.1‑1作業管理画面</strong></p>
</section>
</section>
<section id="id14">
<h2>収集機能の利用手順<a class="headerlink" href="#id14" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">収集機能の利用手順について説明します</div>
</div>
<section id="id15">
<h3>作業フロー<a class="headerlink" href="#id15" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">収集機能の実施における標準的なフローは以下のとおりです。</div>
<div class="line">ITA Ansible-Driverの利用方法は、「利用手順マニュアル_Ansible-Driver」を参照してください。</div>
<div class="line">ITA 基本コンソールの利用方法は、「利用手順マニュアル_基本コンソール」を参照してください。</div>
</div>
<section id="id16">
<h4>収集機能作業フロー<a class="headerlink" href="#id16" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">以下は、Ansible-Legacyで作業を実行するまでの流れです。</div>
</div>
<a class="reference internal image-reference" href="../../../../_images/collect_execflow.png"><img alt="実行フロー" src="../../../../_images/collect_execflow.png" style="width: 5.00372in; height: 3.87662in;" /></a>
<ul class="simple">
<li><p>作業フロー詳細と参照先</p></li>
</ul>
<ol class="arabic">
<li><div class="line-block">
<div class="line">収集機能用のユーザーの作成</div>
<div class="line">ITA管理コンソールの機器一覧の画面から、収集機能用のユーザーを登録します。</div>
<div class="line">登録方法は「利用手順マニュアル_管理コンソールを参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集機能用のロールの作成</div>
</div>
<div class="line-block">
<div class="line">ITA管理コンソールのロール一覧の画面から、収集機能用のロールを登録します。</div>
<div class="line">登録方法は「利用手順マニュアル_管理コンソール」 を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">ロール・ユーザーの紐づけ</div>
<div class="line">ITA管理コンソールのロール・ユーザー紐付の画面から、ロールの紐づけを行います。</div>
<div class="line">登録方法は「利用手順マニュアル_管理コンソール」 を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集インターフェース情報の登録</div>
<div class="line">Ansible共通コンソールの収集インターフェース情報の画面から、接続情報を登録します。</div>
<div class="line">詳細は「5.1.1 収集インターフェース情報」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">パラメータシート（ホスト/オペレーションあり）の作成</div>
<div class="line">メニュー作成コンソールのメニュー定義/作成の画面からのパラメータシートを作成します。</div>
<div class="line">詳細は「利用手順マニュアル_メニュー作成機能」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集項目値管理の登録</div>
<div class="line">Ansible共通コンソールの収集項目値管理の画面から、ソースファイルとパラメータシートの項目の紐付情報の登録をします。</div>
<div class="line">詳細は「5.1.2収集項目値管理」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作業準備</div>
<div class="line">作業実行のための準備を行います。</div>
<div class="line">詳細は、「利用手順マニュアル_Ansible-Driver」、「利用手順マニュアル_Symphony」、「利用手順マニュアル_Conductor」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作業実行</div>
<div class="line">実行日時、投入オペレーション、Movement、ワークフローを選択し処理の実行を指示します。</div>
<div class="line">実行について「利用手順マニュアル_Ansible-Driver」、「利用手順マニュアル_Symphony」、「利用手順マニュアル_Conductor」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集機能実行</div>
<div class="line">作業実行が完了した作業Noを収集機能の対象として、パラメータシートへの登録処理を実施します。</div>
<div class="line">詳細は「 5.3 BackYardコンテンツ」を参照してください。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集状況確認</div>
<div class="line">Ansible-Legacy/Ansible-Pioneer/Ansible-LegacyRoleコンソールの作業管理の画面では、完了した作業の収集状態の確認、ログファイルがDL可能です。</div>
<div class="line">詳細は「5.2.1収集状況の確認」を参照してください。</div>
</div>
</li>
</ol>
</section>
</section>
</section>
<section id="id17">
<h2>収集機能・操作方法説明<a class="headerlink" href="#id17" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本章では、収集機能で利用する各コンソールの機能について説明します。</div>
<div class="line">登録方法の詳細は、関連マニュアルの「利用手順マニュアル_基本コンソール」をご参照下さい。</div>
</div>
<section id="ansible">
<h3>Ansible 共通コンソール<a class="headerlink" href="#ansible" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">本節では、Ansible共通コンソールでの操作について記載します。</div>
</div>
<section id="id18">
<h4>収集インターフェース情報<a class="headerlink" href="#id18" title="この見出しへのパーマリンク">¶</a></h4>
<ol class="arabic">
<li><div class="line-block">
<div class="line">[収集インターフェース情報]では、収集機能で利用するITAの標準RESTAPIを利用する為、RESTAPIアクセス用の接続インターフェース情報の更新を行います。</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image10.png"><img alt="サブメニュー画面（収集インターフェース情報）" src="2.1/ja/manuals/ansible-driver/collect/image10.png" style="width: 5.65382in; height: 2.70023in;" /></a>
<p><strong>図</strong> <strong>5.1-1サブメニュー画面（収集インターフェース情報）</strong></p>
</li>
<li><div class="line-block">
<div class="line">「一覧」-「更新」ボタンより、収集インターフェース情報の登録を行います。</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image11.png"><img alt="更新画面（収集インターフェース情報）" src="2.1/ja/manuals/ansible-driver/collect/image11.png" style="width: 5.475in; height: 0.70833in;" /></a>
<p><strong>図</strong> <strong>5.1-2 更新画面（収集インターフェース情報)</strong></p>
</li>
<li><div class="line-block">
<div class="line">収集インターフェース情報画面の項目一覧は以下のとおりです。</div>
<div class="line">収集インターフェース情報が未登録または、複数レコード登録されている状態で作業実行した場合、<strong>収集機能によるパラメータシートへの登録はされません</strong>。</div>
</div>
</li>
</ol>
<table class="docutils align-default" id="id42">
<caption><span class="caption-text">表 5.1-1 登録画面項目一覧（インタフェース情報）</span><a class="headerlink" href="#id42" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力形式</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ホスト名</p></td>
<td><p>使用するホスト名を入力</p>
<p>初期値:localhost</p>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>IP</p></td>
<td><p>使用するIPを入力</p>
<p>初期値
:127.0.0.1</p>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>RESTユーザー</p></td>
<td><p>使用するITAユーザーのログインIDを入力</p></td>
<td></td>
<td><p>手動入力</p></td>
<td><p>※1</p></td>
</tr>
<tr class="row-odd"><td><p>RESTパスワード</p></td>
<td><p>使用するITAユーザーのログインパスワードを入力</p></td>
<td></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>REST方式</p></td>
<td><p>ホスト名、IPのどちらか使用するものを選択</p>
<ul class="simple">
<li><p>IP</p></li>
<li><p>ホスト名</p></li>
</ul>
</td>
<td><p>〇</p></td>
<td><p>リスト選択</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>プロトコル</p></td>
<td><p>使用するプロトコルを入力</p>
<p>初期値:http</p>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ポート</p></td>
<td><p>使用するポートを入力</p>
<p>初期値:80</p>
</td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>備考</p></td>
<td><p>自由記述欄です。</p></td>
<td><p>ー</p></td>
<td><p>手動入力</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">※1 RESTユーザーに入力されたユーザーは、以下が必須にとなります。</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">ユーザーが所属しているロールが、作成されたパラメータシートのメニューのアクセス権/アクセス許可ロールをもっている。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">メニューのロール情報にて、ユーザーに紐づくロールがメンテナンス可である。</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">ユーザー、ロールの作成、紐付、について「利用手順マニュアル_管理コンソール」を参照してください。</div>
</div>
</section>
<section id="id19">
<h4>収集項目値管理<a class="headerlink" href="#id19" title="この見出しへのパーマリンク">¶</a></h4>
<ol class="arabic">
<li><div class="line-block">
<div class="line">[収集項目値管理]では、収集項目とパラメータシートの項目の紐付設定を行います。</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image12.png"><img alt="サブメニュー画面（収集項目値管理）" src="2.1/ja/manuals/ansible-driver/collect/image12.png" style="width: 5.74716in; height: 2.75357in;" /></a>
<p><strong>図</strong> <strong>5.1-3サブメニュー画面（収集項目値管理）</strong></p>
</li>
<li><div class="line-block">
<div class="line">「一覧」-「登録開始」ボタンより、収集項目の登録を行います。</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image13.png"><img alt="登録画面（収集項目値管理）" src="2.1/ja/manuals/ansible-driver/collect/image13.png" style="width: 5.47222in; height: 0.85139in;" /></a>
<p><strong>図</strong> <strong>5.1-4 登録画面（収集項目値管理）</strong></p>
</li>
<li><div class="line-block">
<div class="line">収集項目値管理画面の項目一覧は以下のとおりです。</div>
</div>
<table class="docutils align-default" id="id43">
<caption><span class="caption-text">表 5.1-1 登録画面項目一覧（収集項目値管理）</span><a class="headerlink" href="#id43" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>入力必須</p></th>
<th class="head"><p>入力形式</p></th>
<th class="head"><p>制約事項</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="4"><p>収集項目(FROM)</p></td>
<td><p>バース形式</p></td>
<td><p>ソースファイルのファイル形式を選択</p></td>
<td><p>〇</p></td>
<td><p>リスト選択</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>PREFIX(ファイル名)</p></td>
<td><p>ソースファイルの拡張子を除いたファイル名を入力</p></td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>※1</p></td>
</tr>
<tr class="row-even"><td><p>変数名</p></td>
<td><p>変数名を入力</p></td>
<td><p>〇</p></td>
<td><p>手動入力</p></td>
<td><p>※1</p></td>
</tr>
<tr class="row-odd"><td><p>メンバー変数</p></td>
<td><p>変数が、複数具体値、多段変数の場合入力</p></td>
<td></td>
<td><p>手動入力</p></td>
<td><p>※1</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>パラメータシ
ート(TO)</p></td>
<td><p>メニューグループ</p></td>
<td rowspan="2"><p>メニュー作成機能で作成されたメニューの一覧から選択</p>
<p>グループ名：メニュー名</p>
</td>
<td rowspan="2"><p>〇</p></td>
<td rowspan="2"><p>リスト選択</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-odd"><td><p>メニュー</p></td>
</tr>
<tr class="row-even"><td><p>項目</p></td>
<td><p>項目を選択</p></td>
<td><p>〇</p></td>
<td><p>リ
スト選択</p></td>
<td><p>※2</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<div class="line-block">
<div class="line">※1 ファイル名、変数、メンバー変数入力値の例</div>
<div class="line">※2 同一の「パラメータシート(TO)-メニューグループ：メニュー-項目」に対して、複数の「PREFIX(ファイル名)-変数名」を設定している場合、ファイル順に処理が実行されます。詳しくは「7.2収集実行例」参照。</div>
</div>
<div class="line-block">
<div class="line">■e.g.) 通常変数の構造の変数の場合</div>
</div>
<div class="highlight-yaml notranslate" id="sample-yml"><div class="highlight"><pre><span></span><span class="nt">■ファイル名</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE.yml</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイルの内容</span>

<span class="nt">VAR_sample_config_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="nt">VAR_sample_config_2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test_parameter</span>

<span class="l l-Scalar l-Scalar-Plain">■収集値項目管理の収集項目(FROM)の入力可能な値</span>

<span class="nt">PREFIX(ファイル名)</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE</span>
<span class="l l-Scalar l-Scalar-Plain">変数名： VAR_sample_config_1</span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">VAR_sample_config_2</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">■ e.g.) 複数具体値の構造の変数の場合</div>
</div>
<div class="highlight-yaml notranslate" id="sample-2-yml"><div class="highlight"><pre><span></span><span class="nt">■ファイル名</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE_2.yml</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイルの内容</span>

<span class="nt">VAR_sample2_conf</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE3</span>

<span class="l l-Scalar l-Scalar-Plain">■収集値項目管理の収集項目(FROM)の入力可能な値</span>
<span class="nt">PREFIX(ファイル名)</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMPLE_2</span>
<span class="l l-Scalar l-Scalar-Plain">変数名： VAR_sample2_conf</span>
<span class="l l-Scalar l-Scalar-Plain">メンバー変数： [0]</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">[1]</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">[2]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">■ e.g.) 複数具体値の構造の変数の場合</div>
</div>
<div class="highlight-yaml notranslate" id="rh-sshd-yml"><div class="highlight"><pre><span></span><span class="nt">■ファイル名</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RH_sshd.yml</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイルの内容</span>

<span class="nt">VAR_RH_sshd_config</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PermitRootLogin</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PasswordAuthentication</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>

<span class="w w-Error"> </span><span class="l l-Scalar l-Scalar-Plain">■収集値項目管理の収集項目(FROM)の入力可能な値</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PREFIX(ファイル名)</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RH_sshd</span>
<span class="w"> </span><span class="nt">変数名： VAR_RH_sshd_config</span><span class="p">:</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">メンバー変数： [0].key</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">[0].value</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">[1].key</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">[1].value</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">■e.g.)複数具体値の構造の変数の場合2</div>
</div>
<div class="highlight-yaml notranslate" id="rh-snmp-yml"><div class="highlight"><pre><span></span><span class="nt">■ファイル名</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RH_snmp.yml</span>
<span class="l l-Scalar l-Scalar-Plain">■ファイルの内容</span>

<span class="nt">VAR_RH_snmpd_info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">com2sec</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">sec_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;testsec&quot;</span>
<span class="w">      </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span>
<span class="w">      </span><span class="nt">community</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">sec_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;local&quot;</span>
<span class="w">      </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span>
<span class="w">      </span><span class="nt">community</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;private&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">■収集値項目管理の収集項目(FROM)の入力可能な値</span>
<span class="nt">PREFIX(ファイル名)</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RH_snmp</span>
<span class="nt">変数名： VAR_RH_snmp_config</span><span class="p">:</span>
<span class="l l-Scalar l-Scalar-Plain">メンバー変数： com2sec[0].sec_name</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">com2sec[0].source</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">com2sec[0].community</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">com2sec[1].sec_name]</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">com2sec[1].source</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">com2sec[1].community</span>
</pre></div>
</div>
</section>
</section>
<section id="ansible-legacyansible-pioneeransible-legacyrole">
<h3>Ansible-Legacy、Ansible-Pioneer、Ansible-LegacyRoleコンソール<a class="headerlink" href="#ansible-legacyansible-pioneeransible-legacyrole" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id20">
<h4>収集状況の確認<a class="headerlink" href="#id20" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">各コンソール（Ansible-Legacy/Ansible-Pioneer/Ansible-LegacyRole）の作業管理の画面では、完了した作業の収集状態の確認、ログファイルがDL可能です。</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image7.png"><img alt="作業管理画面" src="2.1/ja/manuals/ansible-driver/collect/image7.png" style="width: 5.78688in; height: 2.77273in;" /></a>
<p><strong>図</strong> <strong>5.2-1作業管理画面</strong></p>
<table class="docutils align-default" id="id44">
<caption><span class="caption-text">表 5.2-1 作業管理画面収集状況詳細</span><a class="headerlink" href="#id44" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>項目</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ステータス</p></td>
<td><p>収集機能の実行状況の表示</p>
<p>対象外：収集機能対象外　（対象ファイルなし）</p>
<p>収集済み：収集機能実施済み</p>
<p>収集済み（通知あり）：登録/更新中に不備があった場合</p>
<p>収集エラー：Movementのオペレーション、ホストに不備がある場合</p>
</td>
<td><p>※</p></td>
</tr>
<tr class="row-odd"><td><p>収集ログ</p></td>
<td><p>収集機能実行のログをダウンロード</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id45">
<caption><span class="caption-text">表 5.2-2 収集状況詳細</span><a class="headerlink" href="#id45" title="このテーブルへのパーマリンク">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>作業状態</p></th>
<th class="head"><p>収集機能対象</p></th>
<th class="head" colspan="4"><p>収集状況</p></th>
</tr>
<tr class="row-even"><th class="head"><p>ステータス</p></th>
<th class="head"></th>
<th class="head"><p>対象ファイル</p></th>
<th class="head"><p>ステータス</p></th>
<th class="head"><p>収集ログ</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>完了以外</p></td>
<td><p>なし</p></td>
<td><p>対象外</p></td>
<td><p>空</p></td>
<td><p>空</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>完了以外</p></td>
<td><p>あり</p></td>
<td><p>対象外</p></td>
<td><p>空</p></td>
<td><p>空</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>完了</p></td>
<td><p>なし</p></td>
<td><p>対象</p></td>
<td><p>対象外</p></td>
<td><p>ログファイルあり</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>完了</p></td>
<td><p>あり</p></td>
<td><p>対象</p></td>
<td><p>収集済み</p></td>
<td><p>ログファイルあり</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>完了</p></td>
<td><p>あり</p></td>
<td><p>対象</p></td>
<td><p>収集済み(通知あり）</p></td>
<td><p>ログファイルあり</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">※ステータスの表記について</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">作業状態が完了でない場合、収集機能対象外の為、収集状況は更新されないため、空のままとなります。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作業状態が完了で、収集対象ファイルが存在しない場合、ステータスは収集済み、収集ログは空の状態となります。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集インターフェース情報、設定項目値管理、メニューのアクセス権/アクセス許可ロールの不備により、RESTAPIの登録処理が失敗した場合でも収集済み（通知あり）となります。詳細は、収集ログ内を参照。</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><strong>ログファイル出力内容例</strong></div>
</div>
<div class="line-block">
<div class="line">■ e.g.) ログファイル出力内容例 (登録処理成功)</div>
</div>
<div class="highlight-bash notranslate" id="id21"><div class="highlight"><pre><span></span><span class="m">2020</span>-11-13<span class="w"> </span><span class="m">13</span>:51:02<span class="w"> </span>Collect<span class="w"> </span>START<span class="w"> </span><span class="o">(</span><span class="w"> </span>ホスト名:ita-sample<span class="w"> </span>ファイル名:RH_snmpd<span class="w"> </span><span class="o">)</span>
<span class="m">2020</span>-11-13<span class="w"> </span><span class="m">13</span>:51:02<span class="w"> </span>REST<span class="w"> </span>DATA<span class="w"> </span><span class="o">(</span><span class="w"> </span>ホスト名:<span class="w"> </span>ita-sample<span class="w"> </span>メニューID:<span class="w"> </span><span class="m">0000000004</span><span class="w"> </span>オペレーションNO:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">)</span>
Array
<span class="o">(</span>
<span class="w">    </span><span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>http://127.0.0.1:80/default/menu/07_rest_api_ver1.php?no<span class="o">=</span><span class="m">0000000004</span>
<span class="w">    </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[[</span><span class="s2">&quot;更新&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;3&quot;</span>,<span class="s2">&quot;ita-sample&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;2023\/10\/26 16:35_1:OP001&quot;</span>,<span class="s2">&quot;Root &lt;root@localhost&gt; (configure \/etc\/snmp\/snmp.local.conf)&quot;</span>,<span class="s2">&quot;Unknown (edit \/etc\/snmp\/snmpd.conf)&quot;</span>,<span class="s2">&quot;public&quot;</span>,<span class="s2">&quot;notConfigUser&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;T_20201111115557819037&quot;</span>,<span class="s2">&quot;&quot;</span><span class="o">]]</span>
<span class="w">    </span><span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span><span class="s2">&quot;status&quot;</span>:<span class="s2">&quot;SUCCEED&quot;</span>,<span class="s2">&quot;resultdata&quot;</span>:<span class="o">{</span><span class="s2">&quot;LIST&quot;</span>:<span class="o">{</span><span class="s2">&quot;NORMAL&quot;</span>:<span class="o">{</span><span class="s2">&quot;register&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;登録&quot;</span>,<span class="s2">&quot;ct&quot;</span>:0<span class="o">}</span>,<span class="s2">&quot;update&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;更新&quot;</span>,<span class="s2">&quot;ct&quot;</span>:1<span class="o">}</span>,<span class="s2">&quot;delete&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;廃止&quot;</span>,<span class="s2">&quot;ct&quot;</span>:0<span class="o">}</span>,<span class="s2">&quot;revive&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;復活&quot;</span>,<span class="s2">&quot;ct&quot;</span>:0<span class="o">}</span>,<span class="s2">&quot;error&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;エラー&quot;</span>,<span class="s2">&quot;ct&quot;</span>:0<span class="o">}}</span>,<span class="s2">&quot;RAW&quot;</span>:<span class="o">[[</span><span class="s2">&quot;000&quot;</span>,<span class="s2">&quot;200&quot;</span>,<span class="s2">&quot;&quot;</span><span class="o">]]}}}</span>
<span class="o">)</span>
<span class="m">2020</span>-11-13<span class="w"> </span><span class="m">13</span>:51:02<span class="w"> </span>Collect<span class="w"> </span>END<span class="w"> </span><span class="o">(</span><span class="w"> </span>ホスト名:ita-sample<span class="w"> </span>ファイル名:RH_snmpd<span class="w"> </span><span class="o">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">■ e.g.) ログファイル出力内容例 (登録処理失敗)</div>
</div>
<div class="highlight-bash notranslate" id="id22"><div class="highlight"><pre><span></span><span class="m">2020</span>-11-06<span class="w"> </span><span class="m">13</span>:32:52<span class="w"> </span>Collect<span class="w"> </span>START<span class="w"> </span><span class="o">(</span><span class="w"> </span>ホスト名:ita-sample<span class="w"> </span>ファイル名:RH_snmpd<span class="w"> </span><span class="o">)</span>
<span class="m">2020</span>-11-06<span class="w"> </span><span class="m">13</span>:32:52<span class="w"> </span><span class="o">[</span>処理<span class="o">]</span>RESTアクセスに失敗しました。
Array
<span class="o">(</span>
<span class="w">    </span><span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>http://127.0.0.1:80/default/menu/07_rest_api_ver1.php?no<span class="o">=</span><span class="m">0000000005</span>
<span class="w">    </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[[</span><span class="s2">&quot;登録&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;ita-sample&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;2023\/10\/26 16:35_1:OP001&quot;</span>,<span class="s2">&quot;Root &lt;root@localhost&gt;(configure \/etc\/snmp\/snmp.local.conf)&quot;</span>,<span class="s2">&quot;Unknown (edit \/etc\/snmp\/snmpd.conf)&quot;</span>,<span class="s2">&quot;public&quot;</span>,<span class="s2">&quot;notConfigUser&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span><span class="o">]]</span>
<span class="w">    </span><span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span><span class="s2">&quot;Error&quot;</span>:メンテナンス権限がありません。<span class="s2">&quot;,&quot;</span>Exception<span class="s2">&quot;:&quot;</span>Generic<span class="w"> </span>error<span class="s2">&quot;,&quot;</span>StackTrace<span class="s2">&quot;:&quot;</span>none<span class="s2">&quot;}</span>
<span class="s2">)</span>
<span class="s2">2020-11-06 13:32:52 Collect END ( ホスト名:ita-sample ファイル名:RH_snmpd )</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">■ e.g.) ログファイル出力内容例 (対象外)</div>
</div>
<div class="highlight-bash notranslate" id="e-g"><div class="highlight"><pre><span></span><span class="m">2020</span>-11-05<span class="w"> </span><span class="m">16</span>:55:31<span class="w"> </span><span class="o">[</span>処理<span class="o">]</span>対象機器が登録されていないか、廃止されているため、登録、更新処理をスキップ<span class="o">(</span>ホスト名:ita-test<span class="o">)</span>
</pre></div>
</div>
</section>
</section>
<section id="backyard">
<h3>BackYardコンテンツ<a class="headerlink" href="#backyard" title="この見出しへのパーマリンク">¶</a></h3>
<ol class="arabic">
<li><p>パラメータシートへの登録処理の概要</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">収集インターフェース情報の取得</div>
</div>
</li>
<li><div class="line-block">
<div class="line">正常に完了した作業の一覧を取得</div>
<div class="line">収集対象ステータス： 完了</div>
</div>
</li>
<li><div class="line-block">
<div class="line">収集対象作業Noから以下の情報を取得</div>
</div>
<ul class="simple">
<li><p>オペレーション情報</p></li>
<li><p>対象ホスト</p></li>
<li><p>対象ソースファイル</p></li>
</ul>
</li>
<li><div class="line-block">
<div class="line">対象のホストが機器一覧に登録されているか問い合わせ</div>
</div>
<div class="line-block">
<div class="line">登録： 収集対象</div>
<div class="line">未登録： 対象外</div>
</div>
</li>
<li><div class="line-block">
<div class="line">対象ソースファイルと収集項目値管理から対象パラメータシートのメニューIDを取得</div>
<div class="line">※対象ソースファイルが複数ある場合、ファイル名の昇順で処理を実行します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">(1)～（4）の情報からRESTAPIのパラメータを生成</div>
</div>
<div class="line-block">
<div class="line">対象のメニューIDに対して、データの問い合わせを実施し、RESTAPIの実行種別を判定</div>
<div class="line">登録：　一意のオペレーション、ホスト組み合わせのデータが登録されていない</div>
<div class="line">更新：　一意のオペレーション、ホスト組み合わせのデータが登録されている</div>
</div>
</li>
<li><div class="line-block">
<div class="line">ITA標準RESTAPI機能にて、データの登録/更新を実施します。</div>
</div>
</li>
<li><div class="line-block">
<div class="line">作業Noに収集状況のステータスを更新</div>
</div>
</li>
</ol>
</li>
</ol>
<div class="line-block">
<div class="line">なお、パラメータシートへのデータ登録のタイミングは自動プロセスの起動周期に依存します。</div>
<div class="line">起動周期の変更については、後述「<strong>6.2メンテナンス方法について</strong>」を参照してください。</div>
<div class="line">登録・更新されたレコードのアクセス権/アクセス許可ロールは、収集対象の作業結果のアクセス権/アクセス許可ロールを継承します。</div>
<div class="line">対象の作業結果については、別紙「Exastro-ITA_利用手順マニュアル_Ansible-driver」を参照してください。</div>
</div>
</section>
</section>
<section id="id23">
<h2>運用操作<a class="headerlink" href="#id23" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本機能を活用する操作は、クライアントPCのブラウザ画面からのユーザー利用による入力だけでなく、システム運用・保守による操作もあります。用意している運用・保守の操作は次のとおりです。</div>
</div>
<section id="id24">
<h3>メンテナンス<a class="headerlink" href="#id24" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">収集機能のプロセスの開始/停止/再起動に必要なファイルは以下となります。</div>
</div>
<table class="docutils align-left" id="id46">
<caption><span class="caption-text">メンテナンス</span><a class="headerlink" href="#id46" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>説明</p></th>
<th class="head"><p>対象ファイル名</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">パラメータ自動登録</div>
<div class="line">作業実行が完了した、作業結果から、設定項目値管理に登録した情報を元に、パラメータシートへの登録を行う。</div>
</div>
</td>
<td><p>ky_std_synchronize-Collector.service</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">対象ファイルは「/usr/lib/systemd/system」に格納されています。</div>
<div class="line">プロセス起動/停止/再起動の方法は次の通りです。</div>
<div class="line">root権限でコマンドを実行してください。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line">プロセス起動</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># systemctl start ky_std_synchronize-Collector.service</span>
</pre></div>
</div>
</li>
<li><div class="line-block">
<div class="line">プロセス停止</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># systemctl stop ky_std_synchronize-Collector.service</span>
</pre></div>
</div>
</li>
<li><div class="line-block">
<div class="line">プロセス再起動</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># systemctl restart ky_std_synchronize-Collector.service</span>
</pre></div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line">各対象ファイル名に置き換えて起動/停止/再起動を行ってください。</div>
</div>
</section>
<section id="id25">
<h3>メンテナンス方法について<a class="headerlink" href="#id25" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">①　NORMALレベルへの変更</div>
<div class="line">以下のファイルの8行目「DEBUG」を「NORMAL」に書き換えます。</div>
<div class="line">ログレベル設定ファイル：<code class="file docutils literal notranslate"><span class="pre">&lt;インストールディレクトリ&gt;/ita-root/confs/backyardconfs/ita_env</span></code></div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line">②　DEBUGレベルへの変更</div>
</div>
<div class="line">以下のファイルの8行目「NORMAL」を「DEBUG」に書き換えます。</div>
<div class="line">ログレベル設定ファイル：<code class="file docutils literal notranslate"><span class="pre">&lt;インストールディレクトリ&gt;/ita-root/confs/backyardconfs/ita_env</span></code></div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line">③ 起動周期の変更</div>
</div>
<div class="line">各対象ファイルのExecStartの5番目のパラメータを変更します。（単位:秒）</div>
<div class="line">例外を除き起動周期はデフォルト値の使用をしてください。</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">ExecStart</span><span class="o">=</span>/bin/sh<span class="w"> </span><span class="si">${</span><span class="nv">ITA_ROOT_DIR</span><span class="si">}</span>/backyards/common/ky_loopcall-php-procedure.sh<span class="w"> </span>/bin/php<span class="w"> </span>/bin/php<span class="w"> </span><span class="si">${</span><span class="nv">ITA_ROOT_DIR</span><span class="si">}</span>/backyards/terraform_driver/ky_terraform_execute-workflow.php<span class="w"> </span><span class="si">${</span><span class="nv">ITA_ROOT_DIR</span><span class="si">}</span>/logs/backyardlogs<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="si">${</span><span class="nv">ITA_LOG_LEVEL</span><span class="si">}</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">書き換え後、プロセス再起動(restart)後に有効になります。</div>
<div class="line">ログファイルの出力先：<code class="file docutils literal notranslate"><span class="pre">&lt;インストールディレクトリ&gt;/ita-root/logs/backyardlogs</span></code></div>
</div>
</section>
</section>
<section id="id26">
<h2>付録<a class="headerlink" href="#id26" title="この見出しへのパーマリンク">¶</a></h2>
<section id="id27">
<h3>参考資材<a class="headerlink" href="#id27" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">以下、IaC(Playbook、Role)の参考例となります。</div>
</div>
<ol class="arabic">
<li><div class="line-block">
<div class="line-block">
<div class="line">Ansible Playbook Collection（OS設定収集）</div>
</div>
<div class="line"><a class="reference external" href="https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md">https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md</a></div>
</div>
</li>
<li><div class="line-block">
<div class="line">Ansibleコンフィグ取得、パラメータ生成Playbook</div>
</div>
<div class="literal-block-wrapper docutils container" id="makeyml-ansible-yml">
<div class="code-block-caption"><span class="caption-text">makeYml_Ansible.yml</span><a class="headerlink" href="#makeyml-ansible-yml" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">make yaml file</span>
<span class="w">  </span><span class="nt">blockinfile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">create</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0644</span>
<span class="w">    </span><span class="nt">insertbefore</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EOF</span>
<span class="w">    </span><span class="nt">marker</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/tmp/Ansible_conf.yml&quot;</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">ansible_architecture: {{ ansible_architecture }}</span>
<span class="w">      </span><span class="no">ansible_bios_version: {{ ansible_bios_version }}</span>
<span class="w">      </span><span class="no">ansible_default_ipv4__address: {{ ansible_default_ipv4.address }}</span>
<span class="w">      </span><span class="no">ansible_default_ipv4__interface: {{ ansible_default_ipv4.interface }}</span>
<span class="w">      </span><span class="no">ansible_default_ipv4__network: {{ ansible_default_ipv4.network }}</span>
<span class="w">      </span><span class="no">ansible_distribution: {{ ansible_distribution }}</span>
<span class="w">      </span><span class="no">ansible_distribution_file_path: {{ ansible_distribution_file_path }}</span>
<span class="w">      </span><span class="no">ansible_distribution_file_variety: {{ ansible_distribution_file_variety }}</span>
<span class="w">      </span><span class="no">ansible_distribution_major_version: {{ ansible_distribution_major_version }}</span>
<span class="w">      </span><span class="no">ansible_distribution_release: {{ ansible_distribution_release }}</span>
<span class="w">      </span><span class="no">ansible_distribution_version: {{ ansible_distribution_version }}</span>
<span class="w">      </span><span class="no">ansible_machine: {{ ansible_machine }}</span>
<span class="w">      </span><span class="no">ansible_memtotal_mb: {{ ansible_memtotal_mb }}</span>
<span class="w">      </span><span class="no">ansible_nodename: {{ ansible_nodename }}</span>
<span class="w">      </span><span class="no">ansible_os_family: {{ ansible_os_family }}</span>
<span class="w">      </span><span class="no">ansible_pkg_mgr: {{ ansible_pkg_mgr }}</span>
<span class="w">      </span><span class="no">ansible_processor_cores: {{ ansible_processor_cores }}</span>
<span class="w">      </span><span class="no">ansible_processor_count: {{ ansible_processor_count }}</span>
<span class="w">      </span><span class="no">ansible_processor_threads_per_core: {{ ansible_processor_threads_per_core }}</span>
<span class="w">      </span><span class="no">ansible_processor_vcpus: {{ ansible_processor_vcpus }}</span>
<span class="w">      </span><span class="no">ansible_product_name: {{ ansible_product_name }}</span>
<span class="w">      </span><span class="no">ansible_product_serial: {{ ansible_product_serial }}</span>
<span class="w">      </span><span class="no">ansible_product_uuid: {{ ansible_product_uuid }}</span>
<span class="w">      </span><span class="no">ansible_product_version: {{ ansible_product_version }}</span>
<span class="w">      </span><span class="no">ansible_python__executable: {{ ansible_python.executable }}</span>
<span class="w">      </span><span class="no">ansible_python_version: {{ ansible_python_version }}</span>
<span class="w">      </span><span class="no">ansible_service_mgr: {{ ansible_service_mgr }}</span>
<span class="w">      </span><span class="no">ansible_php_config: php.ini</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy the make yaml file to local</span>
<span class="w">  </span><span class="nt">fetch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/tmp/Ansible_conf.yml&quot;</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">__parameter_dir__</span><span class="nv"> </span><span class="s">}}/{{</span><span class="nv"> </span><span class="s">inventory_hostname</span><span class="nv"> </span><span class="s">}}/&quot;</span>
<span class="w">    </span><span class="nt">flat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">get php config</span>
<span class="w">  </span><span class="nt">fetch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/php.ini</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w">  </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">__parameters_file_dir__</span><span class="nv"> </span><span class="s">}}/{{</span><span class="nv"> </span><span class="s">inventory_hostname</span><span class="nv"> </span><span class="s">}}/&quot;</span>
<span class="w">    </span><span class="nt">flat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line">※　makeYml_Ansible.yml実行して、収集対象のソースファイル(yaml)を生成する場合、gather_factsを有効にする必要があります。</div>
<div class="line">「Ansible-Legacy」-「Movement一覧」編集時、「ヘッダーセクション」に以下を記載する。</div>
<div class="line">設定変更については、「利用手順マニュアルAnsible-driver」を参照してください。</div>
</div>
<div class="line-block">
<div class="line">■e.g) gather_facts有効設定例</div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">remote_user</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">__loginuser__</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
</section>
<section id="id28">
<h3>収集実行例<a class="headerlink" href="#id28" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id29">
<h4>複数ファイルの同一メニューを対象とした場合<a class="headerlink" href="#id29" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">収集項目値管理にて、一つの「メニュー-項目」に対して、複数の「PREFIX(ファイル名)-変数名」の設定をしている場合、対象ホストの収集対象ディレクトリ内に、該当する複数のソースファイルがある場合の収集処理の例について記載します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-text">収集対象ファイル</span><a class="headerlink" href="#id30" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>【上位ディレクトリ】
<span class="w">   </span><span class="p">|</span>-<span class="w">  </span>_parameters
<span class="w">       </span><span class="p">|</span>-<span class="w">  </span>ita-sample01
<span class="w">           </span><span class="p">|</span>-<span class="w">  </span>SAMPLE_01.yml
<span class="w">           </span><span class="p">|</span>-<span class="w">  </span>SAMPLE_02.yml
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>■ 収集項目値管理設定</strong></div>
</div>
<div class="line-block">
<div class="line">■ファイル名：SAMPLE_01.yml ,SAMPLE_02.yml</div>
</div>
<table class="docutils align-left" id="id47">
<caption><span class="caption-text">ファイルの内容</span><a class="headerlink" href="#id47" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>SAMPLE_01.yml</p></th>
<th class="head"><p>SAMPLE_02.yml</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">VAR_sample_config_1: 1</div>
<div class="line">VAR_sample_config_2: 2</div>
<div class="line">VAR_sample_config_3: 3</div>
</div>
</td>
<td><div class="line-block">
<div class="line">VAR_sample_config_1: “A”</div>
<div class="line">VAR_sample_config_B: “B”</div>
<div class="line">VAR_sample_config_X: “X”</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><strong>■ 収集値項目管理の設定と対象メニュー項目の収集例</strong></div>
</div>
<div class="line-block">
<div class="line">e.g) 収集値項目管理の設定と対象メニュー-項目</div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image14.png"><img alt="メニュー項目" src="2.1/ja/manuals/ansible-driver/collect/image14.png" style="width: 6.11686in; height: 2.26773in;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image15.png"><img alt="メニュー項目" src="2.1/ja/manuals/ansible-driver/collect/image15.png" style="width: 6.11686in; height: 2.26773in;" /></a>
<div class="line-block">
<div class="line"><strong>■対象ファイル、収集値項目管理の設定内容に沿って、ファイル単位に収集処理を実行</strong></div>
</div>
<ol class="arabic simple">
<li><p>SAMPLE_01.yml の登録処理（登録）</p></li>
</ol>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image16.png"><img alt="SAMPLE_01.yml の登録処理（登録）" src="2.1/ja/manuals/ansible-driver/collect/image16.png" style="width: 6.00785in; height: 0.51786in;" /></a>
<ol class="arabic simple" start="2">
<li><p>SAMPLE_02.yml の登録処理（更新）</p></li>
</ol>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image17.png"><img alt="SAMPLE_02.yml の登録処理（更新）" src="2.1/ja/manuals/ansible-driver/collect/image17.png" style="width: 6in; height: 0.52304in;" /></a>
<ol class="arabic simple" start="3">
<li><p>収集機能完了後のレコードの状態</p></li>
</ol>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image15.png"><img alt="収集機能完了後のレコードの状態" src="2.1/ja/manuals/ansible-driver/collect/image15.png" style="width: 6.06086in; height: 0.52834in;" /></a>
</section>
<section id="id31">
<h4>収集対象ファイルの値の取り扱い<a class="headerlink" href="#id31" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Yaml形式で出力された収集対象ファイルについて、パラメータシートへの登録処理時の値の取り扱いについて以下として扱います。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id32">
<div class="code-block-caption"><span class="caption-text">Sample.yml</span><a class="headerlink" href="#id32" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">VAR_TEST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TEST</span>
<span class="nt">VAR_STR_TEST1</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;TEST1&#39;</span>
<span class="nt">VAR_STR_TEST2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TEST2&quot;</span>
<span class="nt">VAR_null</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">VAR_NULL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NULL</span>
<span class="nt">VAR_STR_null</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;null&quot;</span>
<span class="nt">VAR_STR_NULL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NULL&quot;</span>
<span class="nt">VAR_true</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">VAR_false</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">VAR_STR_true</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">VAR_STR_false</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span>
<span class="nt">VAR_YES</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">YES</span>
<span class="nt">VAR_NO</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="nt">VAR_STR_YES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;YES&quot;</span>
<span class="nt">VAR_STR_NO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NO&quot;</span>
<span class="nt">VAR_NON</span><span class="p">:</span>
<span class="nt">VAR_Quotation</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">VAR_WQuotation</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">■ 収集対象YAML(sample.yml)のキーと値</div>
</div>
<table class="docutils align-left" id="id48">
<caption><span class="caption-text">表 7-1 収集対象YAML(sample.yml)のキーと値</span><a class="headerlink" href="#id48" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 36%" />
<col style="width: 36%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>No</p></th>
<th class="head"><p>キー</p></th>
<th class="head"><p>値</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>VAR_TEST</p></td>
<td><p>TEST</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>VAR_STR_TEST1</p></td>
<td><p>'TEST1'</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>VAR_STR_TEST2</p></td>
<td><p>&quot;TEST2&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>VAR_null</p></td>
<td><p>null</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>VAR_NULL</p></td>
<td><p>NULL</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>VAR_STR_null</p></td>
<td><p>&quot;null&quot;</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>VAR_STR_NULL</p></td>
<td><p>&quot;NULL&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>VAR_true</p></td>
<td><p>true</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>VAR_false</p></td>
<td><p>false</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>VAR_STR_true</p></td>
<td><p>&quot;true&quot;</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>VAR_STR_false</p></td>
<td><p>&quot;false&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>VAR_YES</p></td>
<td><p>YES</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>VAR_NO</p></td>
<td><p>NO</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>VAR_STR_YES</p></td>
<td><p>&quot;YES&quot;</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>VAR_STR_NO</p></td>
<td><p>&quot;NO&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>VAR_NON</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>VAR_Quotation</p></td>
<td><p>''</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>VAR_WQuotation</p></td>
<td><p>&quot;&quot;</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">■ 収集対象YAML(sample.yml)の収集</div>
</div>
<table class="docutils align-left" id="id49">
<caption><span class="caption-text">表 収集対象YAML(sample.yml)の収集</span><a class="headerlink" href="#id49" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 7%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>No</p></th>
<th class="head"><p>収集対象 (キー:値)</p></th>
<th class="head"><p>パラメータシート項目名</p></th>
<th class="head"><p>RESTAPI</p></th>
<th class="head"><p>WEB画面</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>VAR_TEST: TEST</p></td>
<td><p>パラメータ/VAR_TEST</p></td>
<td><p>&quot;TEST&quot;</p></td>
<td><p>TEST</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>VAR_STR_TEST1: 'TEST1'</p></td>
<td><p>パラメータ/VAR_STR_TEST1</p></td>
<td><p>&quot;TEST1&quot;</p></td>
<td><p>TEST1</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>VAR_STR_TEST2: &quot;TEST2&quot;</p></td>
<td><p>パラメータ/VAR_STR_TEST2</p></td>
<td><p>&quot;TEST2&quot;</p></td>
<td><p>TEST2</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>VAR_null: null</p></td>
<td><p>パラメータ/VAR_null</p></td>
<td><p>null</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>VAR_NULL: NULL</p></td>
<td><p>パラメータ/VAR_NULL</p></td>
<td><p>null</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>VAR_STR_null: &quot;null&quot;</p></td>
<td><p>パラメータ/VAR_STR_null</p></td>
<td><p>&quot;null&quot;</p></td>
<td><p>null</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>VAR_STR_NULL: &quot;NULL&quot;</p></td>
<td><p>パラメータ/VAR_STR_NULL</p></td>
<td><p>&quot;NULL&quot;</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>VAR_true: true</p></td>
<td><p>パラメータ/VAR_true</p></td>
<td><p>&quot;1&quot;</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>VAR_false: false</p></td>
<td><p>パラメータ/VAR_false</p></td>
<td><p>&quot;&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>VAR_STR_true: &quot;true&quot;</p></td>
<td><p>パラメータ/VAR_STR_true</p></td>
<td><p>&quot;true&quot;</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>VAR_STR_false: &quot;false&quot;</p></td>
<td><p>パラメータ/VAR_STR_false</p></td>
<td><p>&quot;false&quot;</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>VAR_YES: YES</p></td>
<td><p>パラメータ/VAR_YES</p></td>
<td><p>&quot;1&quot;</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>VAR_NO: NO</p></td>
<td><p>パラメータ/VAR_NO</p></td>
<td><p>&quot;&quot;</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>VAR_STR_YES: &quot;YES&quot;</p></td>
<td><p>パラメータ/VAR_STR_YES</p></td>
<td><p>&quot;YES&quot;</p></td>
<td><p>YES</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>VAR_STR_NO: &quot;NO&quot;</p></td>
<td><p>パラメータ/VAR_STR_NO</p></td>
<td><p>&quot;NO&quot;</p></td>
<td><p>NO</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>VAR_NON:</p></td>
<td><p>パラメータ/VAR_NON</p></td>
<td><p>null</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>VAR_Quotation: ''</p></td>
<td><p>パラメータ/VAR_Quotation</p></td>
<td><p>null</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>VAR_WQuotation: &quot;&quot;</p></td>
<td><p>パラメータ/VAR_WQuotation</p></td>
<td><p>null</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">※パラメータシートの値は、RESTAPIでFILTERの取得結果から、文字列に関して、””で囲った状態で記載しています。</div>
<div class="line">※RESTAPI（FILTER）での取得結果例、WEB画面の表示結果例について記載しています。</div>
</div>
<ul class="simple">
<li><p>対象パラメータシートの画面上の表示結果</p></li>
</ul>
<a class="reference internal image-reference" href="2.1/ja/manuals/ansible-driver/collect/image18.png"><img alt="対象パラメータシートの画面上の表示結果" src="2.1/ja/manuals/ansible-driver/collect/image18.png" style="width: 6.96252in; height: 1.98221in;" /></a>
<ul class="simple">
<li><p>対象パラメータシートのRESTAPI(FILTER)での取得結果</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SUCCEED&quot;</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;resultdata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nt">&quot;CONTENTS&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;RECORD_LENGTH&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;BODY&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">             </span><span class="p">[</span>
<span class="w">                 </span><span class="s2">&quot;実行処理種別&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;廃止&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;No&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;ホスト名&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/ID&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/オペレーション名&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/基準日時&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/実施予定日時&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/最終実行日時&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;オペレーション/オペレーション&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_TEST&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_TEST1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_TEST2&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_null&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_NULL&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_null&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_NULL&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_true&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_false&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_true&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_false&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_YES&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_NO&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_YES&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_STR_NO&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_NON&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_Quotation&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;パラメータ/VAR_WQuotation&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;アクセス権/アクセス許可ロール&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;備考&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;最終更新日時&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;更新用の最終更新日時&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;最終更新者&quot;</span>
<span class="w">             </span><span class="p">],</span>
<span class="w">             </span><span class="p">[</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;OP01&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;2021/11/17 13:30&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;2021/11/23 16:04&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;2021/11/17 13:30&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;2021/11/23 16:04_1:OP01&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;TEST&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;TEST1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;TEST2&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;null&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;NULL&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;YES&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;NO&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;2021/11/17 16:04:28&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;T_20211117160428242847&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="s2">&quot;システム管理者&quot;</span>
<span class="w">             </span><span class="p">]</span>
<span class="w">         </span><span class="p">],</span>
<span class="w">         </span><span class="nt">&quot;UPLOAD_FILE&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id33">
<h4>複数の同一ファイル名がアップロード対象ファイルの指定例<a class="headerlink" href="#id33" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Yaml形式で出力された収集対象ファイルについて、同一ホストで、階層別で同一ファイル名を取り扱う必要がある場合に、アップロード対象ファイルの指定例について記載します。</div>
</div>
<div class="line-block">
<div class="line">■ e.g.)　収集対象ファイルのファイルパス、ディレクトリ構造</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>【上位ディレクトリ】
<span class="w">   </span><span class="p">|</span>-<span class="w">  </span>_parameters
<span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost
<span class="w">   </span><span class="p">|</span><span class="w">       </span><span class="p">|</span>-<span class="w">  </span>SAMPLE.yml
<span class="w">   </span><span class="p">|</span>-<span class="w">  </span>_parameters_file
<span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost
<span class="w">             </span><span class="p">|</span>-<span class="w">  </span>APP001
<span class="w">                 </span><span class="p">|</span>-<span class="w">  </span>config<span class="w">                   </span><span class="c1">#①</span>
<span class="w">             </span><span class="p">|</span>-<span class="w">  </span>APP002
<span class="w">                 </span><span class="p">|</span>-<span class="w">  </span>config<span class="w">                   </span><span class="c1">#②</span>
<span class="w">             </span><span class="p">|</span>-<span class="w">  </span>APP003
<span class="w">                 </span><span class="p">|</span>-<span class="w">  </span>config<span class="w">                   </span><span class="c1">#③</span>
<span class="w">             </span><span class="p">|</span>-<span class="w">  </span>APP002
<span class="w">                 </span><span class="p">|</span>-<span class="w">  </span>config<span class="w">                   </span><span class="c1">#④</span>

<span class="w">  </span>■収集対象ファイル名：SAMPLE.yml
<span class="w">  </span>■ファイルの内容
<span class="w">  </span>VAR_upload_file_1:<span class="w"> </span>config
<span class="w">  </span>VAR_upload_file_2:<span class="w"> </span>‘/&lt;上位ディレクトリ&gt;/_parameters_file<span class="w"> </span>/localhost<span class="w"> </span>/APP002/config’
<span class="w">  </span>VAR_upload_file_3:<span class="w"> </span>‘/APP002/config’
<span class="w">  </span>VAR_upload_file_4:<span class="w"> </span>‘/APP001/config’
<span class="w">  </span>VAR_upload_file_5:<span class="w"> </span>‘/APP003/APP002/config’
</pre></div>
</div>
<div class="line-block">
<div class="line">※上位ディレクトリについては、「2.1収集対象ディレクトリ、ファイル構造」をご参照ください。</div>
<div class="line">収集対象ファイルの内容収集時に対処となるファイルの実体は以下となります。</div>
</div>
<table class="docutils align-left" id="id50">
<caption><span class="caption-text">表 7-3 収集対象ファイルとファイルの実体</span><a class="headerlink" href="#id50" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 40%" />
<col style="width: 40%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>収集項目(FROM)/変数名</p></th>
<th class="head"><p>対象ファイル</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VAR_upload_file_1</p></td>
<td><p>①、②、③、④のファイルからランダム</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>VAR_upload_file_2</p></td>
<td><p>②のファイルが対象</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>VAR_upload_file_3</p></td>
<td><p>②、④のファイルからランダム</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>VAR_upload_file_4</p></td>
<td><p>①のファイルが対象</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>VAR_upload_file_5</p></td>
<td><p>④のファイルが対象</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="id34">
<h4>ファイル削除時の収集対象ファイル内の記載例<a class="headerlink" href="#id34" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">ファイルアップロード項目のファイル削除する場合の収集対象ファイルの指定例について記載します。</div>
<div class="line">削除するファイルについて対象の変数名の値を空文字として設定することで削除可能です。</div>
</div>
<div class="line-block">
<div class="line">■e.g.) ファイルアップロード項目の削除収集対象ファイルのファイルパス、ディレクトリ構造</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>【上位ディレクトリ】
<span class="w">   </span><span class="p">|</span>-<span class="w">  </span>_parameters
<span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost
<span class="w">   </span><span class="p">|</span><span class="w">       </span><span class="p">|</span>-<span class="w">  </span>SAMPLE.yml<span class="w">   </span>※ソースファイル
<span class="w">   </span><span class="p">|</span>-<span class="w">  </span>_parameters_file
<span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span>-<span class="w">  </span>localhost

<span class="w"> </span>■収集対象ファイル名:<span class="w"> </span>SAMPLE.yml
<span class="w"> </span>■ファイルの内容
<span class="w"> </span>VAR_upload_file:<span class="s2">&quot;&quot;</span><span class="w">         </span>※アップロード対象ファイル
</pre></div>
</div>
</section>
</section>
</section>
</section>


</div>


<div id="articleNavigation">
  <ul>
  </ul>
</div>


<div id="pageTopLink">
  <a href="#container"><i>↑</i> Page Top</a>
</div>

</article>
</div>
</main>
</div><!-- End #contents -->
<div id="footer">
  <footer class="divInner">
    <small>Copyright © 2019-2023 NEC Corporation</small>
    <small><a href="/terms/ja.html">サイト規約</a></small>
  </footer>
</div><!-- End #footer -->

<div id="overlay"></div>
<div id="grayBack"></div>

</div><!-- End #container -->
  </body>
</html>